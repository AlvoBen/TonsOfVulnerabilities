<!-- *****************************************************************************************
Page Name          : HUMPowerOfAttorney_R1
Version            : 1.0
Function           : Page to display Power of Attorney related to specific Member
Created Date       : 09/04/2015

Modification Log:
*   Developer                   Code Review     Date               Description
* ------------------------------------------------------------------------------------------------------------------------------                
*   Manish Kumar                22269           09/04/2015          Original Version
*   Gargey Sharma               57200           01/13/2017          REQ - 296804 : Added actionFunction, page message and changed extension Controller
*   Chaitanya Vegendla          87198           04/18/2017          Fixed defect - 273785.0001
*   Prudhvi Pamarthi            170391          01/02/2018          REQ - 328929 Fix for HUMExceptionHelper: DML
*	  Suraj Patil	                            10/30/2018          REQ - 350626 - Power of attorney display from designee service.
*   Shailesh Mali               353777          04/25/2019          REQ - 396397 Hover issue fixed.
**************************************************************************************************************************** -->

<apex:page id="POA" standardController="Account" extensions="PowerOfAttorney_C_HUM" showHeader="false" sidebar="false">

  <apex:stylesheet value="{!URLFOR($Resource.HUMPOA_SR, 'main.css')}"/>
  <apex:includeScript value="{!URLFOR($Resource.HUMPOA_SR, 'main.js')}"/>
  <apex:stylesheet value="{!URLFOR($Resource.CRM_PLATFORM_TOOLKIT, '/CSS/HoverOver.css')}"/>
  <apex:StyleSheet value="{!URLFOR($Resource.HUMMemberSearchComponent, 'HUMMemberSearchComponent/HUMMemberSearchCSS.css')}" />
  <script>
    var getEnclosingPrimaryTabIdC = function getEnclosingPrimaryTabIdC() {
    window.parent.sforce.console.getEnclosingPrimaryTabId(getTabLinkC);
    }
    var getTabLinkC = function getTabLinkC(result) {
    var LoadPOASectionevent = 'LoadPOASectionevent' +result.id;
    window.parent.sforce.console.addEventListener(LoadPOASectionevent, loadPowerOfAttorneySection);
    }
    var loadPowerOfAttorneySection = function (result) {
    var vPOAJSONData = result.message;
    preparePOASection(vPOAJSONData);
    };
    getEnclosingPrimaryTabIdC();
  </script>
  <apex:form >
    <!-- For Constructor Related exception -->
    <c:HUMConstructorExceptionComponent errorLogs="{!listErrorLogs}" />
    <apex:actionStatus id="pleaseWait">
      <apex:facet name="start">
        <div class="waitingSearchDiv waitingSearchDivOpacity outerDIVStyle" ></div>
        <div id="searchingStatus" class="waitingSearchDiv innerDIVStyle" >
          <div class="waitingHolder innermostDIVStyle" >
            <img class="waitingImage" src="/img/loading.gif"/>
            <span class="waitingDescription">{!$Label.LOADING_HUM}</span>
          </div>
        </div>
      </apex:facet>
      <apex:facet name="stop"/>
    </apex:actionStatus>
    <apex:actionFunction action="{!checkConditionForCallout}" name="checkConditionForCallout" status="pleaseWait" rerender="poaTable,opPgMsg"/>
    <apex:outputpanel id="opPgMsg">
      <apex:pageMessages id="pbsMsg"/>
    </apex:outputpanel>
    <apex:pageBlock mode="maindetail">
      <apex:pageBlockTable value="{!lstKeyTOCIMember}" var="poa" id="poaTable">
        <apex:column headerValue="{!lstFieldSet[0]}" value="{!mapServiceResponse[poa][0]}"/>
        <apex:column headerValue="{!lstFieldSet[1]}" value="{!mapServiceResponse[poa][1]}"/>
        <apex:column headerValue="{!lstFieldSet[2]}" value="{!mapServiceResponse[poa][2]}"/>
        <apex:column value="{!mapServiceResponse[poa][3]}">
          <apex:facet name="header">
            <apex:outputPanel >
              {!lstFieldSet[3]}
              <apex:outputPanel styleClass="vfHelpText" id="hoverOverArea">
                <apex:commandLink onclick="javascript:void(O);" html-log_this="false">
                  <apex:image id="lnkImg" style="margin-top: 2px; margin-left: 1px;" styleClass="imgMargin hoverimagesize" value="{!$Resource.HUMHoverOverQuestionMark}"/>
                  <apex:outputPanel styleClass="hoverfontstyle" >
                    {!$Label.POA_HOVEROVERTEXT1} <br/>
                    {!$Label.POA_HOVEROVERTEXT2} <br/>
                    {!$Label.POA_HOVEROVERTEXT3} <br/>
                    {!$Label.POA_HOVEROVERTEXT4}
                  </apex:outputPanel>
                  <style>
                   .vfHelpText a:hover span {width:253px !IMPORTANT;top: -1.15em !IMPORTANT;left: -15.50em !IMPORTANT;}
                  </style>
                </apex:commandLink>
              </apex:outputPanel>
            </apex:outputPanel>
          </apex:facet>
        </apex:column>
      </apex:pageBlockTable>
    </apex:pageBlock>
    <apex:actionFunction action="{!processPOA}" name="preparePOASection" status="pleaseWait" rerender="poaTable,opPgMsg">
      <apex:param id="idresultForPOA" name="resultForPOA" value="" assignTo="{!lstPOAData}" />
    </apex:actionFunction>
  </apex:form>
  <script type="text/javascript">
    var vPOAPermision = "{!$Permission.DesigneeServiceSwitch}";
    if(vPOAPermision == 'false')
    {
    checkConditionForCallout();
    }
  </script>
</apex:page>