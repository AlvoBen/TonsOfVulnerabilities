<!--
Page Name        : Go365UnsecurePrechat_VF_HUM
Version          : 1.0 
Created Date     : 12/12/2019   
Function         : This page is Go365 pre-chat survey form Which is filled in by user before chat is initiated.
Modification Log :
*   Modification ID     Developer               Code Review             Date                 Description
* ------------------------------------------------------------------------------------------------------------------------------                
*   1.0                Joel George                                      12/12/2019           Original       
*   1.1                Akshay Pai                                       02/18/2021           REQ - 1910316 - SonarQube Scan issue fix
*   1.2             Alvaro Madrid                                       09/08/2022           REQ - 3750632 - Adding BotTranscript to LiveChat Agent.
*   1.3            Shivani Shrivastav                                   05/10/2022           REQ - 3788174 - Update Unsecure Go365.com Pre Chat Survey
-------------------------------------------------------------------------------------------------------------------------------->
<apex:page controller="Go365UnsecureChat_C_HUM" id="thePage" showheader="false" standardStyleSheets="false" action="{!initVariable}">
  <!-- Loading CSS files received from digital team for Humana view standards -->
  <link rel="stylesheet" text="text/css" href="{!URLFOR($Resource.HumGo365LiveAgentCSS,'/content/dist/css/go365.css')}"/>
  <link rel="stylesheet" text="text/css" href="{!URLFOR($Resource.HumGo365SampleCSS,'/c2csample/custom.css')}"/>
    <link rel="stylesheet" text="text/css" href="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/styles.css')}"/>
    <link rel="stylesheet" text="text/css" href="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/tools.css')}"/> 
    
  <!-- Loading jQuery toolkit as per VF standards -->
	<apex:includeScript value="{!URLFOR($Resource.CRM_JQUERY, 'jquery.min.js')}" />

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
      <style>
            /* Chrome, Safari, Edge, Opera */
            input[type=number]::-webkit-outer-spin-button,
            input[type=number]::-webkit-inner-spin-button {
              -webkit-appearance: none;
              margin: 0;
            }
            
            /* Firefox */
            input[type=number] {
              -moz-appearance: textfield;
            }
      </style>
    <title>{!$Label.HUMPreChat}</title>

  </head>

  <body class="x5">
  
  <!-- Start Tealium analytics v1_3 - do not remove or change -->
<script type="text/javascript">
    var utag_data = {};
        if (typeof HumAnalytics == "undefined"){
            var HumAnalytics = window.HumAnalytics = {};}
    HumAnalytics.appid = [];
    HumAnalytics.autorenewflag = [];
    HumAnalytics.copayexcflag = [];
    HumAnalytics.prodcat = [];
    HumAnalytics.prodid = [];      
    HumAnalytics.prodname = [];
    HumAnalytics.prodpkgqty = [];      
    HumAnalytics.prodqty = [];
    HumAnalytics.prodsav = [];   
    HumAnalytics.prodtranstype = [];          
    HumAnalytics.prodtype = []; 
    HumAnalytics.produp = [];
</script>

<!-- Loading script asynchronously -->
<script type="text/javascript">
    (function(a,b,c,d){
    a='{!JSENCODE(sWebChatVarMap['Go365Unsecure_Tealium'].value__c)}';
    b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
    a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
</script>
<!-- End Tealium analytics - do not remove or change -->

    <main>
    <form class="go-form x1" id="prechatForm" method="post">
      <div class="container" id="preChat">
        <div class="chat-page-heading">
          <h1>Go365 chat</h1>
        </div>
        <div class="chat-wrapper">
          <div class="row">
            <div class="seventeen columns x1-left">
              <p class="x1">
                  {!$Label.Go365_Unsecure_Thank_You_Msg} {!$Label.Go365_Unsecure_Thank_You_Msg_Part2}</p> 
            </div>
            
              <div class="row" id="FnDiv">
                  <p class="x2" style="font-weight: normal !IMPORTANT;">
                     Required <img src="https://www.humana.com/Areas/HumanaCom/Content/images/forms/required.png" alt="Required" />
                  </p>
                  
                  <label> 
                      First name 
                      <img alt="Required" class="required-icon" id="FirstNameRequired" src="{!URLFOR($Resource.HUMLiveAgentCSS,'/library/images/forms/required.png')}"/>
                  </label>
                  <br/>
                  <label class="label" for="firstName">
                      <img alt="error" class="error-icon displayStyle" id="categorySelectError" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/error.png')}"/>
                      <span class="field-validation-error errMsgStyle displayStyle" id="categorySelectErrMsg"><br/>{!$Label.HUMRequiredErrMsg}</span>
                  </label><br/>
                  <input type="text" name="liveagent.prechat:ContactFirstName" class="six input-text validation" id="firstName" size="20" onfocus="removeErrorClass();"/><br />
                </div>
                
                <br/>
                <div class="row" id="LnDiv">
                    <label>
                        Last name
                         <img alt="Required" class="required-icon" id="categorySelectRequired" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/required.png')}"/>
                    </label>
                     <br/>
                    <label class="label" for="lastName">            
                        <img alt="error" class="error-icon displayStyle" id="categorySelectError" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/error.png')}"/>
                        <span class="field-validation-error errMsgStyle displayStyle" id="categorySelectErrMsg">{!$Label.HUMRequiredErrMsg}</span>
                    </label><br/>
                    <input type="text" name="liveagent.prechat:ContactLastName" class="six input-text validation" id="lastName" size="20" onfocus="removeErrorClass();"/><br />
                </div>
                  <br/>
                    <apex:outputPanel rendered="{!go365RoutingSwitch}">
                      <div class="row" id="DobDiv">
                          <label>
                              Date of Birth (xx/xx/xxxx)
                              <img alt="Required" class="required-icon" id="dateOfBirthRequired" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/required.png')}"/>
                          </label><br/>
                          <label class="label" for="dateOfBirth">            
                              <img alt="error" class="error-icon displayStyle" id="categorySelectError" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/error.png')}"/>
                              <span class="field-validation-error errMsgStyle displayStyle" id="categorySelectErrMsg">{!$Label.HUMRequiredErrMsg}</span>
                          </label><br />
                          <input type="date" name="liveagent.prechat:DOB" class="six input-text validation" id="dateOfBirth" onfocus="removeErrorClass();"/><br />
                      </div>
                        <br/>
                  <div class="row" id="ZcDiv">
                      <label>
                          Zip Code 
                          <img alt="Required" class="required-icon" id="zipCodeRequired" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/required.png')}"/>
                      </label>
                      <br/>
                      <label class="label" for="zipCode">            
                          <img alt="error" class="error-icon displayStyle" id="categorySelectError" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/error.png')}"/>
                          <span class="field-validation-error errMsgStyle displayStyle" id="categorySelectErrMsg">{!$Label.HUMRequiredErrMsg}</span>
                      </label><br/>
                      <input type="number" name="liveagent.prechat:ZipCode" class="six input-text validation" id="zipCode" maxLength="5" onKeyUp="validateZipCode()" onfocus="removeErrorClass();"/><br />
                      <div id="errMsg"></div>
                  </div>
                  <br/>
                 </apex:outputPanel>
                <div class="row">
                    <label>
                        Member ID (optional)
                    </label><br/>
                    <input type="text" name="liveagent.prechat:HumId" class="six input-text validation" id="humId" size="20"/><br />
                    Member ID is required to answer member-specific questions.
                </div>
                <br/>
              <apex:outputPanel rendered="{!go365RoutingSwitch}">
            <div class="row" id="PtDiv">
                    <label>
                        Plan Type
                        <img alt="Required" class="required-icon" id="PlanTypeRequired" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/required.png')}"/>
                    </label>
                    <br/>
                    <label class="label" for="planType">            
                        <img alt="error" class="error-icon displayStyle" id="categorySelectError" src="{!URLFOR($Resource.HUMUnsecureLiveAgentCSS,'/library/images/forms/error.png')}"/>
                        <span class="field-validation-error errMsgStyle displayStyle" id="categorySelectErrMsg">{!$Label.HUMRequiredErrMsg}</span>
                    </label><br/>
                    <select name="liveagent.prechat:Plan Name" class="six input-text validation" id="planType" size="1" onchange="fnHandlePlanChange(this)" onfocus="removeErrorClass();">
                      <option value="">{!$Label.Go365UnsecSelect}</option>
                      <option value="Medicare or Medicaid">{!$Label.Go365UnsecMedicare}</option>
                      <option value="Insurance through my employer">{!$Label.Go365UnsecInsurance}</option>
                    </select>  
                      <br /> 
                    </div>
                <br/>
               </apex:outputPanel>
              <div id="chatAvailable">
                 <div class="go-form-group">
                  <p class="">
                    <label for="Textarea" class="text-input">
                      {!$Label.HUMIssueLabel}
                    </label>

                    <textarea class="go-form-input" cols="5" id="issue" name="liveagent.prechat:Issue" onfocus="removeErrorMessage(this);" onkeyup="textLimit(this,200);" rows="7"/>

                    <span class="field-validation-valid" data-valmsg-for="Textarea" data-valmsg-replace="true"></span>
                    <span class="hidden error-icon left p1-right">
                      <img src="{!URLFOR($Resource.HUMLiveAgentCSS,'/library/images/forms/error.png')}" alt="error" />
                    </span>
                  </p>
                </div>
                <p>
                  {!$Label.Go365TermsOfUse1} <a href="#" onclick="fnGoToTermsOfUse();" class="go-default-link">{!$Label.HUMUnsecureTermsOfUse2}</a>
                </p>

                <button type="submit" onclick="createSubmitURL();return false;" class="go-strong-button">
                  <span>Start chat</span>
                </button>

                <a href="javascript:window.close();" class="go-primary-button">
                  <span>{!$Label.HUMCancel}</span>
                </a>
              </div>              

          </div>
        </div>
      </div>
    
    <!-- Interaction  Association starts -->
                            <input name="liveagent.prechat:ChatType" type="hidden" value="{!sChatTypeGo365}" id="ChatTypeValue" />
                            <input name="liveagent.prechat.save:ChatType" type="hidden" value="Chat_Type__c"/> 
                           
                           
                            <input type="hidden" name="liveagent.prechat:CallerName" id="prechat_field_name" value="" />
                            <input type="hidden" name="liveagent.prechat.name" id="prechat_visitor_name" value="" /> 
                            <input type="hidden" name="liveagent.prechat:CurrQueue" id="prechat_field_currqueue" value=""/>
                            <input type="hidden" name="liveagent.prechat:IntOrigin" value="Web Chat" />    
                            <input name="liveagent.prechat.findorcreate.map:Interaction__c" type="hidden" value="Caller_Name__c,CallerName;Interaction_Origin__c,IntOrigin;Created_By_Queue__c,CurrQueue"/>
                            <input type="hidden" id="createdInt" name="liveagent.prechat.findorcreate.map.doCreate:Interaction__c" value="Caller_Name__c,true;Interaction_Origin__c,true;Created_By_Queue__c,true" />
                           
                            <input name="liveagent.prechat.findorcreate.saveToTranscript:Interaction__c" id="int2" type="hidden" value="Interaction__c"/>
                            <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Interaction__c" id="int3" value="true" />     
        <!-- Interaction  Association ends -->     
                            <input name="liveagent.prechat:BotTranscript" type="hidden" value="" id="BotTranscriptDecrypt" />
                            <input name="liveagent.prechat.save:SecChatID" type="hidden" value="Secondary_Chat_ID__c"/>
                            <input name="liveagent.prechat:SecChatID" id="secchatid" type="hidden" value=""/>
                            <input name="liveagent.prechat.save:SkillName" type="hidden"  value="SkillId"/> 
                            <input name="liveagent.prechat:SkillName" id="prechat_field_SkillName" type="hidden" value=""/>
                            <input name="liveagent.prechat:URL" id="testURI" type="hidden" value=""/>
                            <input name="liveagent.prechat.save:URL" type="hidden" value="URL__c"/>

                            <input name="liveagent.prechat.findorcreate.map:LiveChatTranscript" type="hidden" value="SkillId,SkillName;Secondary_Chat_ID__c,SecChatID;FirstName__c,ContactFirstName;LastName__c,ContactLastName;Humana_ID__c,HumId"/>
                            <input type="hidden" name="liveagent.prechat.findorcreate.map.doCreate:LiveChatTranscript" value="SkillId,true;Secondary_Chat_ID__c,true;FirstName__c,true;LastName__c,true;Humana_ID__c,true" />
                            <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:LiveChatTranscript" value="true" />  

                            <input name="liveagent.prechat.save:HumId" type="hidden" value="Humana_ID__c"/>
                            <input name="liveagent.prechat.save:ContactFirstName" type="hidden" value="FirstName__c"/>
                            <input name="liveagent.prechat.save:ContactLastName" type="hidden" value="LastName__c"/>

                            <input name="liveagent.prechat.save:Issue" type="hidden" value="Issue__c"/>
                             
                            <input name="liveagent.prechat:deployment_id" id="depId" type="hidden" value="{!sWebChatVarMap['DeploymentID'].value__c}"/>
                            <input name="liveagent.prechat:org_id" id="comId" type="hidden" value="{!sWebChatVarMap['CompanyID'].value__c}"/>
                            <input name="liveagent.prechat:SelBtnId" type="hidden" id="SelButttonID" value=""/>
                            <input name="liveagent.prechat.findorcreate.displayToAgent:SelBtnId" type= "hidden" value= "false" />
                          
                            <input name="liveagent.prechat.findorcreate.displayToAgent:BotTranscript" type= "hidden" value= "false" />
                            <input name="liveagent.prechat.findorcreate.displayToAgent:deployment_id" type= "hidden" value= "false" />
                            <input name="liveagent.prechat.findorcreate.displayToAgent:org_id" type= "hidden" value= "false" /> 
                            <input name="liveagent.prechat.findorcreate.displayToAgent:InteractionId" type= "hidden" value= "false" />
                            
                            <input name="liveagent.prechat:InteractionId" id="interactionid" type="hidden" value=""/>
                            <input name="liveagent.prechat:InteractionName" id="interactionname" type="hidden" value=""/>
                            <input name="liveagent.prechat.findorcreate.map:Account" type="hidden" value="Id,AccountId"/>

    
      <div class="row" id="termsOfUse">
        <div class="container" id="preChat">
          <div class="chat-page-heading">
            <h1>Go365 chat</h1>
          </div>
          <br/>
          <div class="thirteen columns x1-left">
            <H2 style="color: #164aad;">
            &nbsp;&nbsp;{!$Label.HUMTermsOfUse2}</H2>
            <div class="row">
              <ul class="go-list" style="text-indent: 0em!IMPORTANT;list-style-position: inherit;">
                <li>
                    {!$Label.Go365_Unsecure_See_Our}
                  <a class="go-default-link" href="{!$Label.Go365_Unsecure_Legal}" target="_blank" rel="noopener noreferrer">{!$Label.go365_Unsecure_LegalDisclaimer}</a>
                  {!$Label.Go365_Unsecure_Here}
                </li>
                <li>
                    {!$Label.Go365_Unsecure_See_Our}
                  <a class="go-default-link" href="{!$Label.go365_Unsecure_IPS_Link}" target="_blank" rel="noopener noreferrer">{!$Label.go365_Unsecure_IPS}</a>
                  {!$Label.Go365_Unsecure_Here}
                </li>
                <li>
                    {!$Label.Go365_Unsecure_See_Our}
                  <a class="go-default-link" href="{!$Label.Go365_Unsecure_NPP_Link}" target="_blank" rel="noopener noreferrer">{!$Label.Go365_Unsecure_NPP}</a>
                  {!$Label.Go365_Unsecure_Here}
                </li>
                
                <li>{!$Label.Go365_Unsecure_Term_4}</li>
                <li>{!$Label.Go365_Unsecure_Term_5}</li>
                <li>{!$Label.Go365_Unsecure_Term_6}</li>
              </ul>
            </div>
            <br/>
            <div class="row x1">
              <div class="eighteen columns">
                <button type="button" onclick="fnGoBackToPreChat();" class="go-strong-button">
                  <span>{!$Label.HUMBack}</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      </form>
    </main>
  </body>
    <apex:includeScript value="{!URLFOR(sWebChatVarMap['DeploymentJS'].value__c)}"/>
    <apex:includeScript value="{!URLFOR(sWebChatVarMap['PreChatJS'].value__c)}"/>
    <apex:includeScript value="{!URLFOR($Resource.Go365UnsecureLiveAgentCSS,'/library/HUMPreChat.js')}"/> 

  <script type="text/javascript">
        var sSecondary_Chat_Id = '{!JSENCODE(sSecondary_Chat_Id)}';
        var sSelbtnId = document.getElementById('SelButttonID');
        var sUrlNew = '';
        var sUr = document.getElementById("testURI");
        sSelbtnId.value= '{!JSENCODE(chatBtnId)}';
        var sIntId = document.getElementById('interactionid');
        var sIntMemberId = document.getElementById('intMemberId');
        var sInteractionName = document.getElementById('interactionname'); 
        var sTheForm = document.forms["prechatForm"];
        var stheFormToSubmit = document.getElementById("prechatForm");
        var selectedID = '{!JSENCODE(chatBtnId)}'; 
        var sSkillName = '{!JSENCODE(sSkillName)}';
        var sCurrQueue = '{!JSENCODE(sUserQueue)}';
        var sDecryptBotTranscript = document.getElementById("BotTranscriptDecrypt");
        var sRemotingTargetOnLoadDecrypt = '{!$RemoteAction.Go365UnsecureChat_C_HUM.decryptUserIdentifiers}';
        var go365RoutingSwitchStart = {!go365RoutingSwitch};
        document.getElementById('secchatid').value = sSecondary_Chat_Id ;        
        jQuery(document).ready(function(){
        jQuery('#termsOfUse').hide();
         });
        
       
        liveagent.details.preChatInit("{!JSENCODE(sWebChatVarMap['LiveChatURL'].value__c)}", 'detcall');                  
         //liveagent initialization

        liveagent.init("{!JSENCODE(sWebChatVarMap['LiveChatURL'].value__c)}","{!JSENCODE(sWebChatVarMap['DeploymentID'].value__c)}","{!JSENCODE(sWebChatVarMap['CompanyID'].value__c)}", false, true);

    </script>
  </apex:page>