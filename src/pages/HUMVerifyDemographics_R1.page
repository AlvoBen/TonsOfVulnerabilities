<!-- *****************************************************************************************
Page Name          : HUMVerifyDemographics
Version            : 1.0
Function           : Page to display Verify Demographics section in Account Page
Created On         : 06/04/2014

Modification Log:
*   Developer                   Code Review     Date               Description
* ------------------------------------------------------------------------------------------------------------------------------              
*   Kritika Popat               17076           06/04/2014          Original Version
*   Asha Deepika Koyyana        18218           09/08/2014          As a part of defect fix #153891,modified the static resource
                                                                    to display the page as a subtab instead of popup
*  Asha Deepika Koyyana         18355           10/06/2014          As per requirement (#2411) added error message tag.
*  Asha Deepika Koyyana         19104           11/05/2014          As per requirement (#2411) added error message.   
*  Shiva Pasumarty                              08/01/2016          REQ - 277174: Fixed CA Ticket to handle Verify button
*  Subhamay Mondal								              04/07/2017			REQ - 306385 - Highlight on the "Verify Demographics" section on Member account page
*  Subhamay Mondal								              06/15/2017			REQ - 320485 - Highlight the "Verify Demographics" section on the Member account page (CRM)
* Dinesh Subramaniyan							              01/12/2018			REQ - 349663 - Ability to display indicators on Quick Start when Member Demographic Verification and/or Guidance Alerts are due (RF)
* Sai Ayyagari                  172913          01/23/2018                REQ - 328929 Fix for HUMExceptionHelper: DML
*  Subhamay Mandal                              04/13/2018          REQ - 360212 AHT - QS Member Demographic Verification andor Guidance Alerts are due (CRM)
*  Ajay Chakradhar                              07/29/2020          REQ - 1065536 Replace the Person Service on Verify demographics from SOAP to REST
* Firoja Begam              1946387              02/24/2021           T1PRJ0002736/PR00094232 - 2021 - MF6 - Security - Checkmarx High Defects in Release_2021_02_21 - SF - TECH - Type: "inputText Ignoring FLS" - Remediation
* Firoja Begam                2237351               05/03/2021          On/Off Switch Cleanup for requirements deployed
* Vardhman Jain                                  02/29/2024           US5303780 - Classic VIT Remediation COB, Policy Member, Verify and update Demographics ; VIT37070839, VIT37935980,   VIT37935986
****************************************************************************************** -->

<apex:page id="pageId" standardController="Account" extensions="HUMVerifyFamilyServiceController_R1"    sidebar="false"  showHeader="false" >
    <apex:includeScript value="/support/console/30.0/integration.js" />
    <apex:includeScript value="{!URLFOR($Resource.HUMVerifyFamily_R1, 'HUMVerifyFamily/HumVerifyFamily.js')}" /> 

    <script language="javascript" type="text/javascript">
       var newwindow;
       var policyPage ='{!$Page.HUMPolicyName}';
       var urlParameters='?';
       var accountId = '{!JSENCODE(sAccId)}'; //assign value of accountId directly from Controller not using inputHidden
    </script>

    <apex:form id="formId">
       
       <!-- For Constructor Related exception -->
        <c:HUMConstructorExceptionComponent errorLogs="{!listErrorLogs}" />
       <apex:outputPanel id="formPanel">
       
           <apex:pagemessages id="error"> </apex:pagemessages> 
           <apex:outputPanel rendered="{!bRender }">
                <apex:pageBlock id="pageBlockId" mode="maindetail" >
					      <script>
						      
						      var bVerifyMessage = {!bVerifyMessage};
						      fireVerifyDemographics(bVerifyMessage);
					      </script>
                   <!--Removed inputHIdden to fix Checkmarx inputText ignoring FLS-->
                    <apex:pageblockButtons location="top">
                        <apex:commandButton value="Verify" onclick="HUMVerifyDemographics_R1VerifyRest(); return false;" rendered="{!bCoreApiServiceREST}"/>
                        <apex:commandButton value="Verify Family" onclick="redirectoPolicyPage(); return false;" />
                    </apex:pageblockButtons>
                    <apex:outputPanel style="text-align:left;padding-left: 25%;" id="displayMessage" layout="block" rendered="{!bVerifyMessage}">
                     		<label>{!$Label.VerifyDemoGraphicsMessage_HUM}</label>
                     </apex:outputPanel>
                    <apex:pagemessages id="error1"> </apex:pagemessages>
                    <apex:pageBlockSection columns="1" id="pageBlockTableId">
                        <apex:pageBlockTable value="{!lstVerifyDemoWrapper}" var="item" rendered="{!bCoreApiServiceREST}">
                            <apex:column value="{!item.sLastVerifiedBy}" headerValue="Last Verified By" style="{!IF(bVerifyMessage,'background-color: #fce5bd','')}"/>
                            <apex:column value="{!item.sLastVerifiedOn}" headerValue="Last Verified On" style="{!IF(bVerifyMessage,'background-color: #fce5bd','')}"/>
                            <apex:column value="{!item.iDaysSinceLastVerified}" headerValue="Days Since Last Verified" style="{!IF(bVerifyMessage,'background-color: #fce5bd','')}" id="columnId" />               
                        </apex:pageBlockTable>
                    </apex:pageBlockSection>
                </apex:pageBlock>
           </apex:outputPanel> 
       
       </apex:outputPanel>
       
       <apex:actionFunction action="{!verifyDemographics}" name="HUMVerifyDemographics_R1Verify" reRender="pageBlockId,error1"/>
       <apex:actionFunction action="{!getLastVerifyDates}" name="HUMVerifyDemographics_R1JSCALL" id="HUMVerifyDemographics_R1JSCALL" reRender="formPanel"/>
       <apex:actionFunction action="{!verifyDemographicsRest}" name="HUMVerifyDemographics_R1VerifyRest" reRender="pageBlockId,error1"/>
       <apex:actionFunction action="{!getLastVerifyDatesRest}" name="HUMVerifyDemographics_R1JSCALLRest" id="HUMVerifyDemographics_R1JSCALLRest" reRender="formPanel"/>
    </apex:form>
    <script>
    var vCoreApiServiceREST = '{!bCoreApiServiceREST}';
    if(vCoreApiServiceREST == 'true'){
        HUMVerifyDemographics_R1JSCALLRest();    
    }else{ 
        HUMVerifyDemographics_R1JSCALL();
    }
    </script>
</apex:page>