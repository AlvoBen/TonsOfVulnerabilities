<!--
Component        : Pharmacy Invoice Request
Version          : 1.0
Created On       : 09/06/2023
Function         : Component to display to pharmacy invoice request

Modification Log:
* Developer Name                       Date                         Description
* Nirmal Garg                          09/06/2023                  Original Version
*------------------------------------------------------------------------------------------------------------------------------
-->
<template>
    <template if:true={loaded}>
        <template if:true={invoiceRequest}>
            <div>
                <section role="dialog" tabindex="-1"
                    class="slds-modal slds-fade-in-open slds-modal_medium flow-modal-component"
                    aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <lightning-button-icon icon-name="utility:close" alternative-text="Close this window"
                                size="large" variant="bare-inverse" onclick={handleflowabort} class="slds-modal__close">
                            </lightning-button-icon>
                            <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Invoice Request</h2>
                        </header>
                        <template if:true={flowname}>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <template if:true={firstRequest}>
                                    <c-screen-flow onflowstatuschange={handleflowfinished}
                                        onflowfailed={handleflowfailed} width="100%" height="500px;"
                                        flow-name={flowname} flow-params={flowParamsJSON}>
                                    </c-screen-flow>
                                </template>
                                <template if:false={firstRequest}>
                                    <lightning-tabset>
                                        <template for:each={invoiceProcessData} for:item="item">
                                            <template if:true={item.processExist}>
                                                <lightning-tab label={item.label} key={item.label}
                                                    style="height: 500px;">
                                                    <lightning-formatted-rich-text value={item.value}>
                                                    </lightning-formatted-rich-text>
                                                </lightning-tab>
                                            </template>
                                            <template if:false={item.processExist}>
                                                <lightning-tab label={item.label} key={item.label}
                                                    style="height:500px ">
                                                    <c-screen-flow onflowstatuschange={handleflowfinished}
                                                        onflowfailed={handleFlowFailed} width="100%" height="500px;"
                                                        flow-name={flowname} flow-params={flowParamsJSON}>
                                                    </c-screen-flow>
                                                </lightning-tab>
                                            </template>
                                        </template>
                                    </lightning-tabset>
                                </template>
                            </div>
                        </template>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open flow-modal-component"></div>
            </div>
        </template>
        <template if:true={invoiceRequestFinalScreen}>
            <c-generic-case-comment-logging record-id={recordId} onfinish={handleFinishLogging}
                responseobj={invoiverequestobj} filter-cases-having-template={filterCasesHavingTemplate}>
            </c-generic-case-comment-logging>
        </template>
        <template if:true={isConfirmingFlowExit}>
            <c-generic-unsaved-changes-prompt-hum header={labels.UnsavedChangesHeader}
                message={labels.unsavedModalMsgHum} button-config={buttonConfig} promptclass={promptclass}
                oncancel={handleCancelFlowExit} oncontinue={handleContinueFlowExit}>
            </c-generic-unsaved-changes-prompt-hum>
        </template>
        <c-generic-modal-hum if:true={bIsFlowFinished} b-show-modal={bIsFlowFinished} onclose={handleNo}
            onyes={handleYes} onno={handleNo} buttons-config={modalButtonConfig}>
            <div slot="content" class="slds-modal__content slds-var-p-around_medium">
                <P class="slds-text-align_center slds-var-m-top_xx-large slds-var-m-bottom_xx-large">Does the member
                    want to request another type of invoice?</P>
            </div>
        </c-generic-modal-hum>
    </template>
</template>