<!--
LWC Name        : pharmacyHpieOrderDetailsEditHum.html
Function        : LWC to display pharmacy Hpie order edit details.

Modification Log:
* Developer Name                  Date                         Description
*
* Swapnali Sonawane               09/07/2023                   US - 5058187
* Jonathan Dickinson              11/02/2023                   DF - 8267
* Jonathan Dickinson              02/29/2024                   User Story 4835317: T1PRJ0865978 - MF 27481 - C12; Mail Order Management; Pharmacy - Mail Order Pharmacy page gap- Member Consent (Lightning)
* Jonathan Dickinson              03/01/2024                   User Story 5058187: T1PRJ1295995 - (T1PRJ0870026)- MF 27409 HPIE/CRM SF - Tech - C12 Mail Order Management - Pharmacy - "Prescriptions & Order summary" tab - "Edit Order'
****************************************************************************************************************************-->

<template>
    <div class="slds-p-around_medium">
        <lightning-layout multiple-rows="true">
            <lightning-layout-item size="12">
                <div class="slds-grid slds-gutters slds-p-around_small">
                    <div class="slds-col slds-size_3-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Shipping Method <lightning-icon icon-name="utility:rotate"
                                        size="xx-small"></lightning-icon></p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue slds-wrap">
                                    {orderDetailsResponse.shippingMethod} </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Payer</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue slds-wrap">{spayer}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_1-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Status</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">{orderDetailsResponse.status}
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_1-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Carrier</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.carrier}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Tracking Number</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12" class="slds-truncate_container_75">
                                <p class="slds-text-link slds-truncate " style=" font-size: 12px;cursor:pointer;"
                                    onclick={trackingNumberPopUp} title={orderDetailsResponse.trackingNumber}>
                                    {orderDetailsResponse.trackingNumber}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Cancel Reason</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.cancelReason}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>

                </div>
            </lightning-layout-item>
            <lightning-layout-item size="12">
                <div class="slds-grid slds-gutters slds-p-around_small">
                    <div class="slds-col slds-size_3-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Shipping Address <lightning-icon icon-name="utility:rotate"
                                        size="xx-small"></lightning-icon></p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue slds-wrap">
                                    <template if:true={shippingAddress}>
                                        <lightning-formatted-address street={shippingHomeStreet}
                                            city={shippingAddress.city} country="US"
                                            province={shippingAddress.stateCode}
                                            postal-code={shippingAddress.zipCode} disabled>
                                        </lightning-formatted-address>
                                    </template>
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="slds-float_left" style=" font-size: 11px;">Current Order Queue</p>
                                <lightning-button-icon icon-name="utility:refresh" size="small"
                                    alternative-text="Refresh" class="slds-var-p-left_small iconcolor" title="Refresh"
                                    onclick={getOrderDetails}></lightning-button-icon>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.currentQueue} </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <template if:true={checkCode}>
                        <div class="slds-col slds-size_1-of-12">
                            <lightning-layout multiple-rows="true">
                                <lightning-layout-item size="12">
                                    <p class="authlabel">Finance</p>
                                </lightning-layout-item>
                                <lightning-layout-item size="12">
                                    <p class="authvalue">
                                        {orderDetailsResponse.financeCode}</p>
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>
                    </template>

                    <div class="slds-col slds-size_2-of-12 ">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Creation</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.createdDate}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12 ">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Release <lightning-icon icon-name="utility:rotate"
                                        size="xx-small"></lightning-icon></p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <c-generic-date-selector dhelptext="" dkeyname="ReleaseDate" dminvalue={sMinDate}
                                    onsenddatedata={handleDateChange} dvalue={orderReleaseDate} dmaxvalue={sMaxDate}>
                                </c-generic-date-selector>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12" class="slds-var-p-left_xx-large">
                                <p class="authlabel">Finished</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12" class="slds-var-p-left_xx-large">
                                <p class="authvalue">
                                    {orderDetailsResponse.finishedDate}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                </div>


            </lightning-layout-item>
        </lightning-layout>
    </div>
    <div class="slds-p-around_small">
        <div class="custom-box slds-box slds-p-around_medium" style="min-height:300px;">
            <lightning-layout-item size="12">
                <div class="slds-grid slds-gutters">
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Payment Method <lightning-icon icon-name="utility:rotate"
                                        size="xx-small"></lightning-icon></p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.paymentMethod}
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Source</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">
                                    {orderDetailsResponse.source}</p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">CAP Type</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p class="authvalue">{capType}
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Order Total</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p>
                                    <lightning-formatted-number value={orderDetailsResponse.orderTotal}
                                        format-style="currency" currency-code="USD" maximum-fraction-digits="2"
                                        class="authvalue">
                                    </lightning-formatted-number>
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Order Copay</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p>
                                    <lightning-formatted-number value={orderDetailsResponse.copayAmount}
                                        format-style="currency" currency-code="USD" maximum-fraction-digits="2"
                                        class="authvalue">
                                    </lightning-formatted-number>
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                    <div class="slds-col slds-size_2-of-12">
                        <lightning-layout multiple-rows="true">
                            <lightning-layout-item size="12">
                                <p class="authlabel">Order Tax</p>
                            </lightning-layout-item>
                            <lightning-layout-item size="12">
                                <p>
                                    <lightning-formatted-number value={orderDetailsResponse.taxAmount}
                                        format-style="currency" currency-code="USD" maximum-fraction-digits="2"
                                        class="authvalue">
                                    </lightning-formatted-number>
                                </p>
                            </lightning-layout-item>
                        </lightning-layout>
                    </div>
                </div>
            </lightning-layout-item>
            <lightning-layout-item size="12">
                <div class="slds-border_top slds-var-p-top_large"></div>
            </lightning-layout-item>
            <template if:true={displayOTCMessage}>
                <div class="counterOrderText">
                    <h4>{overTheCounterMsg}</h4>
                </div>
            </template>
            <div>
                <h3>
                    <span class="slds-page-header__title slds-truncate" title="Order Items">Order
                        Items</span>
                </h3>
            </div>
            <template if:true={orderDetailsData}>
                <c-pharmacy-hpie-order-lines-hum onsplitorderclick={getSplitOrderDetails} payer={payer}
                    orderparentnode={orderDetailsData} orderprescription={prescriptions}
                    called-from-edit-order={calledFromEditOrder} ondeletescriptkeyfromlist={handleDeleteScriptKey}
                    onconsentgiven={handleConsentGiven} member-consent={memberConsent}
                    is-member-consent-queue={isMemberConsentQueue} is-member-consent-required={isMemberConsentRequired}>
                </c-pharmacy-hpie-order-lines-hum>
            </template>
        </div>
    </div>
    <!--Shipping Address Module-->
    <div>
        <div class="slds-grid slds-wrap slds-m-left_small slds-m-right_small slds-m-top_small">
            <div class="slds-col slds-size_5-of-12">
                <p style="font-weight: 600;">Shipping Address</p>
            </div>
            <div class="slds-col slds-size_7-of-12">
                <div class="slds-grid slds-wrap">
                    <div class="slds-col slds-size_4-of-12">
                        <p class="slds-float_right" style="font-weight: 600;">Payment Methods</p>
                    </div>
                    <div class="slds-col slds-size_4-of-12">
                        <p> <lightning-button label="New Credit Card" title="New Credit Card" onclick={handleNewClick}
                                class="slds-m-left_x-small slds-float_right"></lightning-button></p>
                    </div>
                    <div class="slds-col slds-size_4-of-12">
                        <p><lightning-button label="Edit Credit Card" title="Edit Credit Card" onclick={handleEditClick}
                                class="slds-m-left_x-small slds-float_right"></lightning-button></p>
                    </div>
                </div>
            </div>
            <div class="slds-col slds-size_4-of-12 slds-m-top_small">
                <lightning-combobox name="progress" label="Shipping Method" value={selectedShippingMethod}
                    placeholder="Shipping Method" options={shippingoptions} onchange={handleShippingChange}
                    required></lightning-combobox>
            </div>
            <div class="slds-col slds-size_2-of-12 slds-m-top_small">

            </div>
            <div class="slds-col slds-size_6-of-12 slds-m-top_small">
                <lightning-combobox name="progress" label="Credit Card/Invoice" value={paymentMethod}
                    placeholder="Credit Card" options={lstPaymentMethods} onchange={handlePaymentChange}
                    required></lightning-combobox>
            </div>
            <div class="slds-col slds-size_7-of-12 slds-m-top_x-large">
                <c-pharmacy-hpie-modify-shipping-address enterprise-id={enterpriseId} record-id={recordId}
                    network-id={networkId} pharmacymemberaddresss={pharmacyaddress}
                    demographics-data={pharmacydemodetails} oncalldemographics={handleCallDemographics}
                    dropdown-alignment="auto" user-id={userId} onshippingaddress={updateShippingAddress}>
                </c-pharmacy-hpie-modify-shipping-address>
            </div>
        </div>
    </div>
    <!--Credit Card Module-->
    <div class="slds-m-top_small">
        <template if:true={isCreateAndEditCreditCardVisible}>
            <c-pharmacy-hpie-create-edit-credit-card-hum record-id={recordId} enterprise-id={enterpriseId}
                network-id={networkId} user-id={userId} component-mode={createAndEditCreditCardComponentMode}
                credit-card-data={creditCardData} selected-row-data={selectedRowData} onsave={handleSave}
                oncancel={handleCancel} oncreditcardkey={handleCreditKey}>
            </c-pharmacy-hpie-create-edit-credit-card-hum>
        </template>
    </div>
    <template if:false={loaded}>
        <lightning-spinner alternative-text="Loading...">
        </lightning-spinner>
    </template>
</template>