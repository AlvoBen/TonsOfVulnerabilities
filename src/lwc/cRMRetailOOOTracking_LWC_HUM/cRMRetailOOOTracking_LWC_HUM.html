<!--
Component Name   :CRMRetailOOOTracking_LCMP_HUM
Version          : 1.0
Created On       : 07/28/2021
Function         : Lightning Web Component to create and edit CRMRetail_OOO_Tracking__c records 

Modification Log: 
* Developer Name           Code Review                 Date                         Description
*****************************************************************************************************************************
* Abhishek Maurya                                 07/28/2021                    User Story 2491779 -CRM Storefront SDoH: One-on-One Tracking Enhancements 
* Vinoth L                      				  09/02/2021                    User Story - 2508432 T1PRJ0001894 - MF 7 - CRM Storefront SDoH: Share Screening Results - Call DH&A 
* Abhishek Maurya               				  09/02/2021                    User Story - 2599455 T1PRJ0001894 - MF 7 - CRM Storefront SDoH: Share Screening Results - Update Existing 1x1 Tracking
* Vinoth L                      				  06/03/2022                    User Story 3434998: T1PRJ0154546 / SF / MF9 Storefront: Duplicate Notification Interactions
* Vinoth L                      				  02/28/2023           			User Story 4349337: T1PRJ0154546 / SF / MF9 Storefront: Deprecate Old Home Page Components
* Mohamed Thameem                                 27/05/2023                    User Story - 4647349 T1PRJ0154546 / SF / MF9 Storefront - Add Last 3 One-On-One Information
****************************************************************************************************************************
-->
<template>
    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-modal_small slds-fade-in-open">        
        <div class="slds-modal__container oneOoneModal">  
            <header class="slds-modal__header">
                <lightning-button-Icon icon-name="utility:close"
                                      onclick={cancelMainModal}
                                      alternative-text="close"
                                      variant="inverse"
                                      class="slds-modal__close close_Button_Record_Edit_Form"></lightning-button-Icon>
                <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">{recordFormLabel}</h2>
            </header>
            <div class={styleClass} id="modal-content-id-1"> 
                <template if:true={switch_3434998}>
                    <template if:true={isShowSpinnerMain}>
                        <lightning-spinner alternative-text="Loading" size="medium" class="spinnerClass"></lightning-spinner>
                    </template>  
                </template>                                         
                <lightning-record-edit-form class="oneOoneFormId"
                                          record-id={oooRecordId} 
                                          object-api-name="CRMRetail_OOO_Tracking__c"
                                          onload={handleFormLoad}
                                          onsuccess={handleFormSuccess}
                                          onerror={handlerOOOError}
                                          >
                    <lightning-messages class="showErrorText">
                    </lightning-messages>
                    <div id="modalContainer" class="FormBackGround ">

                        <template if:true={showRecentOOOSection}>
                            <div class="Section">
                                <div class="SectionHeader">
                                    <h2 class="SectionHeaderH2">Recent One-on-One Tracking</h2>
                                </div>
                                <div class="SectionBody recentOOOSection">
                                    <template if:true={showRecentOOOTable}>
                                        <lightning-datatable hide-checkbox-column	
                                            key-field="Id"
                                            data={oOOTrackingRecords}
                                            columns={oOOTrackinColumns}>
                                        </lightning-datatable>
                                    </template>
                                    <template if:true={showNoOOOData}>
                                        <div>{NoOOORecordLabel}</div>
                                    </template>
                                </div>
                            </div>
                        </template>

                        <div class="Section">
                            <div class="SectionHeader">
                                <h2 class="SectionHeaderH2">Information</h2>
                            </div>
                            <div class="SectionBody">
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Account__c" class="accId" disabled ></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="CRM_Retail_Location__c" class="locId" disabled ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Appointment_Date__c" class="appointmentDateId" disabled ></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2 ">
                                        <lightning-input type="time" required label="Time"  class="appointmentTimeId slds-width-adjust"></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2 slds-hidden">
                                        <lightning-input-field required="true" field-name="Appointment_Time__c" class="appointmentTimeHiddenId" ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Visitor_Type__c"  class="visitorTypeId" disabled></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Caregiver_Present__c" class="inputVal" ></lightning-input-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="Section">
                            <div class="SectionHeader">
                                <h2 class="SectionHeaderH2">One-on-One Details</h2>
                            </div>
                            <div class="SectionBody">
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2 ">
                                        <lightning-input-field field-name="Number_of_People__c"  required class="inputVal" ></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2 ">
                                        <lightning-input-field field-name="Length_of_Visit_in_minutes__c"  required  class="inputVal" ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2 ">
                                        <lightning-input-field field-name="Reason_for_Visit__c" required  class="inputVal"></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Description_of_Visit__c" required class="inputVal" ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Specific_Resources_Used__c" class="inputVal" ></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Other_Comments__c" class="inputVal" ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="SDoH_Screening_Completed__c"  onchange={hideDependencyError} class="sdoHCompletedId"></lightning-input-field>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="Gap_in_Care_Discussion__c" class="inputVal" ></lightning-input-field>
                                    </div>
                                </div>
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input-field field-name="SDoH_Determinants__c" class="sdohDetermntId" ></lightning-input-field>
                                    </div>
                                    <div class="slds-grid">
                                    <div  class=" slds-col slds-hidden slds-size_1-of-2">
                                        <lightning-input-field field-name="CRM_Retail_Interaction__c" class="interactionId"></lightning-input-field>
                                    </div>
                                </div>
                                </div>
                                <div class="slds-grid">
                                    <div class=" slds-col slds-hide slds-size_1-of-2 sdohDeterRequiredId">
                                        <p style="color:red">At least one SDoH Determinant must be selected when SDoH Screening Completed is checked</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <template if:true={isShowSystemInfo}>
                        <div class="Section">
                            <div class="SectionHeader">
                                <h2 class="SectionHeaderH2">System Information</h2>
                            </div>
                            <div class="SectionBody">
                                <div class="slds-grid">
                                    <div class="slds-col slds-grid slds-size_1-of-2">
                                            <span>
                                                <lightning-output-field field-name="LastModifiedById" disabled ></lightning-output-field>
                                            </span>
                                            <span class="paddingAroundLastModiBy">
                                                <lightning-output-field field-name="LastModifiedDate" variant="label-hidden" ></lightning-output-field>
                                            </span>
                                    </div>
                                    <div class="slds-col slds-grid slds-size_1-of-2 ">
                                            <span>
                                                <lightning-output-field field-name="CreatedById" disabled ></lightning-output-field>
                                            </span>
                                            <span class="paddingAroundCreatedBy">
                                                <lightning-output-field field-name="LastModifiedDate" variant="label-hidden" ></lightning-output-field>
                                            </span>   
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>    
                    </div>                    
                </lightning-record-edit-form>
            </div>
            <footer class="slds-modal__footer">
                <div class="slds-col" >
                    <lightning-button class="slds-m-top_small cancelBtnId"  onclick={cancelMainModal} name="Cancel" label="Cancel" ></lightning-button>&nbsp;
                    <template if:true={isShowSaveAndNew}>
                        <lightning-button class="slds-m-top_small saveAndNewBtnId"   onclick={handleFormSubmit} name="Save And New" label="Save And New"></lightning-button>&nbsp;
                    </template>
                    <lightning-button class="slds-m-top_small saveBtnId" variant="brand"  onclick={handleFormSubmit} name="Save" label="Save"></lightning-button>
                </div>
            </footer>
        </div>
        
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
    
    <template if:true={isShowScreenigModal}>
        <template if:false={switch_3434998}>
            <template if:true={isShowSpinner}>
                <div class="demo-only demo-only_viewport" style="height:30rem;position:relative">
                    <div role="status" class="slds-spinner slds-spinner_large slds-spinner_brand">
                        <span class="slds-assistive-text">Loading</span>
                        <div class="slds-spinner__dot-a"></div>
                        <div class="slds-spinner__dot-b"></div>
                    </div>
                </div>
            </template>
        </template>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-modal_small slds-fade-in-open">
            <div class="slds-modal__container">  
                <header class="slds-modal__header">
                        <lightning-button-icon icon-name="utility:close"
                                              onclick={closeScreenigModel}
                                              alternative-text="close"
                                              variant="inverse"                                              
                                              class="slds-modal__close close_Button_Screening"></lightning-button-icon>
                        <h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">Social Determinant Screening Results</h2>
                    </header>
                <div class={divStyleClass} id="modal-content-id-2">
                    <template if:true={switch_3434998}>
                        <template if:true={isShowSpinner}>
                            <lightning-spinner alternative-text="Loading" size="medium" class="spinnerClass"></lightning-spinner>
                        </template>
                    </template>                    
                    <div class="slds-grid ">
                        <div class=" slds-col slds-size_1-of-1">
                            Account : {accountName} <br></br>
                            
                            {moveDeterText} <br></br>
                        </div>
                    </div>
                    <div class="slds-grid">
                        <div class=" slds-col slds-size_1-of-1">
                            <lightning-dual-listbox name="SDoH Determinants"
                                                   label= "SDoH Determinants"
                                                   class="socialDeterDualBoxId dualListWidth"
                                                   source-label="Available"
                                                   selected-label="Chosen"
                                                   disable-reordering="true"
                                                   value ={currentChosenValues}
                                                   onchange={onChangeSdhoDeteminants}
                                                   options={selectedDeterminentsForScreening}
                             ></lightning-dual-listbox>
                        </div>
                    </div>
                </div>  
                <footer class="slds-modal__footer ">
                     <div class="slds-align_right">
                        <lightning-button variant="neutral"
                                          label="Cancel"
                                          title="Cancel"
                                          onclick={closeScreenigModel}></lightning-button>&nbsp;
                        <lightning-button variant="brand"
                                          label="Save"
                                          title="Save"
                                          onclick={submitScreeningResults}></lightning-button>
                    </div>
                    </footer>
            </div>
        </section>        
    </template>
    
    <template if:true={isShowConfirmationModal}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal  slds-fade-in-open">
            <div class="slds-modal__container">                
                <div class="border_confirmation">                
                    <div class="slds-modal__content" id="modal-content-id-3">
                        <header class="slds-modal__header">
                            <lightning-button-Icon icon-name="utility:close"
                                                  onclick={closeConfirmationModel}
                                                  alternative-text="close"
                                                  variant="inverse"
                                                  class="slds-modal__close close_Button_Conf"></lightning-button-icon>
                            <h2 id="modal-heading-03" class="slds-text-heading_medium slds-hyphenate">Confirmation Required</h2>
                        </header>
                        <div class="slds-grid">
                            <div class=" slds-col slds-size_1-of-1 confirmationModalMargin">
                                No determinants were chosen this member. Is this correct?
                            </div>
                        </div>                        
                    </div>
                    <footer class="slds-modal__footer">
                        <div class="slds-align_absolute-center">
                        <lightning-button variant="neutral"
                                          label="No"
                                          title="No"
                                          onclick={closeConfirmationModel}></lightning-button>&nbsp;
                        <lightning-button variant="brand"
                                          label="Yes"
                                          title="Yes"
                                          onclick={submitConfirmationDetails}></lightning-button>
                       </div>
                    </footer>
                </div>                 
            </div>
        </section>         
    </template>      
</template>