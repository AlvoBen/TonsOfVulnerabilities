<!--
LWC Name        : PharmacyOrderSummaryFilterHum.html
Function        : LWC to display pharmacy order cards.

Modification Log:
* Developer Name                  Date                         Description
* Pallavi Shewale				  12/10/2021			       US-2664846 Original Version
* Swapnali Sonawane               12/05/2022                   US- 3969790 Migration of the order queue detail capability
****************************************************************************************************************************-->
<template>
    <template if:false={orderIDClick}>
        <lightning-card>
            <div class="slds-grid slds-m-left_x-small slds-wrap">
                <div class="slds-col slds-size_1-of-1 ">
                    <div class="slds-grid slds-grid_align-spread">
                        <div class="slds-col">
                            <h3>
                                <span class="slds-page-header__title slds-truncate" title="Order Summary">
                                    Order Summary
                                </span>
                            </h3>
                        </div>
                        <div class="slds-col">
                            <div class="slds-col_bump-right">
                                <lightning-button-icon icon-name="utility:refresh" variant="border-filled" size="small"
                                                       alternative-text="Refresh" class="slds-float_right" title="Refresh"
                                                       onclick={getRefreshedData}>
                                </lightning-button-icon>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slds-grid slds-wrap">
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-keyword-search-hum minchar="3" placeholder="Filter By" name="searchByWord" keyword={keyword} ontextclear={clearSearchData}
                                                  onkeywordvalue={handleKeywordSearch}>
                    </c-generic-keyword-search-hum>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-date-selector dkeyname="StartDate" dminvalue={sMinDate} onsenddatedata={handleDateChange}
                                             dvalue={sStartDate} dmaxvalue={sMaxDate}>
                    </c-generic-date-selector>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-date-selector dkeyname="EndDate" onsenddatedata={handleDateChange} dvalue={sEndDate}
                                             dmaxvalue={sMaxDate}>
                    </c-generic-date-selector>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-multiselect-picklist-hum keyname="OTC" options={filterFldValues.OTC}
                                                        placeholdermessage="OTC" onmultiselectfilter={handlePicklistFilter} setvalues={filterObj.OTC}>
                    </c-generic-multiselect-picklist-hum>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-multiselect-picklist-hum keyname="OrderStatusLiteral"
                                                        options={filterFldValues.OrderStatusLiteral} placeholdermessage="Status"
                                                        onmultiselectfilter={handlePicklistFilter} setvalues={filterObj.OrderStatusLiteral}>
                    </c-generic-multiselect-picklist-hum>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-p-around_x-small">
                    <c-generic-multiselect-picklist-hum keyname="OrderSource" options={filterFldValues.OrderSource}
                                                        placeholdermessage="Source" onmultiselectfilter={handlePicklistFilter}
                                                        setvalues={filterObj.OrderSource}>
                    </c-generic-multiselect-picklist-hum>
                </div>
            </div>
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-small">
                <div class="slds-col">
                    <template if:true={pillFilterValues}>
                        <template for:each={pillFilterValues} for:item="pill" for:index="ind">
                            <lightning-pill class="slds-m-around_x-small" data-index={ind} data-key={pill.key}
                                            data-value={pill.value} label={pill.value} key={pill.key} onremove={handlePillRemove}>
                            </lightning-pill>
                        </template>
                    </template>
                </div>
            </div>
        </lightning-card>
        <lightning-card>
            <template if:true={loaded}>
                <template if:false={serviceError}>
                    <template if:true={dataFound}>
                        <div class="slds-grid slds-p-bottom_xx-small">
                            <div class="slds-col">
                                <div class="slds-var-m-top_large">
                                    <div class="slds-border_top">
                                    </div>
                                </div>
                            </div>
                            <div>
                                <lightning-button class="slds-align_absolute-center" variant="brand-outline"
                                                  disabled={isMoreOrderSummaryList} label="Show More" onclick={ShowMoreCards}>
                                </lightning-button>
                            </div>
                            <div class="slds-col">
                                <div class="slds-var-m-top_large">
                                    <div class="slds-border_top">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-grid slds-grid_align-end">
                            <div class="slds-col">
                                <span style="text-align: right;">{filteredcount} of {totalcount} results</span>
                            </div>
                        </div>
                        <div class="slds-scrollable_y" style="height: 400px;" onscroll={handlescroll}>
                            <div class="slds-grid slds-wrap">
                                <template if:true={finalOrderList}>
                                    <template for:each={finalOrderList} for:item="orderList">
                                        <div class="slds-col slds-size_4-of-12 slds-p-around_small" key={orderList.key}>
                                            <c-pharmacy-order-card-hum onorderidclickselect={handleOrderIDSelect}
                                                                       enterpriseid={enterpriseid} networkid={netWorkId} recordid={recordId}
                                                                       startdate={eStartDate} enddate={eEndDate} item={orderList.orderList}
                                                                       totalamount={orderList.totalAmount} onviewrx={handleViewRxClick}>
                                            </c-pharmacy-order-card-hum>
                                        </div>
                                    </template>
                                </template>
                            </div>
                        </div>
                    </template>
                    <template if:false={dataFound}>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_1-of-1 slds-m-top_small slds-wrap">
                                <c-generic-scoped-notification-hum iconname="utility:info" message="No Orders are available for selected member.">
                                </c-generic-scoped-notification-hum>
                            </div>
                        </div>
                    </template>
                </template>
                <template if:true={serviceError}>
                    <div class="slds-grid slds-wrap">
                        <div class="slds-col slds-size_1-of-1 slds-m-top_small slds-wrap">
                            <c-generic-scoped-notification-hum type="error" iconname="utility:error" message={labels.pharmacyOrderError}>
                            </c-generic-scoped-notification-hum>
                        </div>
                    </div>
                </template>
            </template>
            <template if:false={loaded}>
                <lightning-spinner alternative-text="Loading"></lightning-spinner>
            </template>
        </lightning-card>
    </template>
    <template if:true={orderIDClick}>
        <c-pharmacy-order-details-hum prescriptions={prescData} onbackclick={showOrderSummary} allorderdetails={orderSummaryList}
                                      orderdetails={selectedOrder} omsdetails={omsdetails} recordid={recordid} networkid={networkid}
                                      enterpriseid={enterpriseid} payer={payer} pharmacydemographicdetails={pharmacydemographicdetails}>
        </c-pharmacy-order-details-hum>
    </template>
    <template if:true={showRXPopUp}>

        <section aria-describedby="dialog-body-id-106" aria-labelledby="dialog-heading-id-5" style="background-color: #f3f2f2; border: 1px solid #dddbda ;" class="slds-popover slds-popover_prompt slds-popover_prompt_top-left custompopover" role="dialog">

            <lightning-button-icon icon-name="utility:close" variant="bare"
                                   class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close"
                                   title="close" style="margin-top:6px;" onclick={closeRXPanel} label="Close">
            </lightning-button-icon>

            <header class="slds-popover__header" style="border: 1px solid #f3f2f2 ;background-color: white;">
                <h1 class="slds-text-heading_small">
                    <b>Order Summary</b>
                </h1>
            </header>

            <div class="slds-popover__body" id="dialog-body-id-106">
                <div class="slds-media">
                    <div class="slds-media__body">
                        <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right slds-m-top_xx-small">
                            <lightning-icon size="x-small"
                                            class="slds-icon slds-input__icon slds-input__icon_right slds-icon-text-default"
                                            icon-name="utility:search">
                            </lightning-icon>
                            <input type="text" data-name='searchByWord' name="searchByWord"
                                   id="text-input-id-2" placeholder="Search" onkeyup={findByWordRxPopup}
                                   data-key="searchByWord" class="slds-input keyword-field state-field" />
                        </div>
                        <div class="slds-var-m-around_small">{countOrders} Item(s) Selected</div>
                        <div class="slds-scrollable_y" style="height: 500px;">
                            <ul class="slds-accordion" style="background-color: white;">
                                <template for:each={rxOderDataFinalQueue} for:item="item">
                                    <c-pharmacy-rx-panel-item item={item} expanded={item.expanded} key={item.orderKey}></c-pharmacy-rx-panel-item>
                                </template>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </template>
</template>