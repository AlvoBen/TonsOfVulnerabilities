<!--
*******************************************************************************************************************************
Page Name        : crmRetail_Scancard_LWC_HUM
Version          : 1.0 
Created Date     : 07/08/2022
Function         : Lightning web component used for the Scan Card functionality.
Modification Log :
* Developer                 Code review         Date                  Description
*******************************************************************************************************************************
* Navajit Sarkar       	                	    07/08/2022            Original Version
* Mohamed Thameem      	                	    01/12/2023            Request 3866581 - Mobile Scanner
* Mohamed Thameem      	                	    08/28/2023            User Story 5012149: T1PRJ0154546 / DP / MF9 Storefront - Update Guest Card # Logic
* Vinoth L										10/03/2023			  User Story 5225414: T1PRJ0154546 / SF / MF9 Storefront - Show Future Policy Members in Search Results
-->
<template>
    <template if:true={initiateScanFromDesktop}>
        <div>
            <!-- Modal/Popup Box LWC starts here -->
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <lightning-button-icon icon-name="utility:close"

                                                 onclick={closeModal}
                                                 alternative-text="close"

                                                 variant="bare"
                                                 class="slds-modal__close" ></lightning-button-icon>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Scan Card</h2>
                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div class="slds-modal__content slds-p-around_medium slds-is-relative" id="modal-content-id-1">
                        <div class="modalDiv">
                            <template if:true={showScanField}>
                                <div class="barcodeDiv">
                                    <lightning-input type="text" name="Scan Field" placeholder="Card scan area" label={labelValue}
                                    min-length={guestCardConfigs.minLength} max-length={guestCardConfigs.maxLength}
                                     class="slds-m-bottom_medium slds-col slds-size--1-of-1 
                            slds-small-size--1-of-2 slds-medium-size--3-of-4 barcodeInput">
                                    </lightning-input>
                            </div>
                                <template if:true={isSpinnerVisible}>
                                    <div class="slds-spinner_container">
                                        <div class="slds-spinner_brand slds-spinner slds-spinner--large slds-is-relative"
                                            role="alert">
                                            <span class="slds-assistive-text">Loading</span>
                                            <div class="slds-spinner__dot-a"></div>
                                            <div class="slds-spinner__dot-b"></div>
                                        </div>
                                    </div>
                                    <!--lightning-spinner alternative-text="Loading" variant="brand" role="alert" class="spinnerClass slds-spinner_large"></lightning-spinner-->
                                </template>
                            </template>
                            <template if:true={showInvalid}>
                                <lightning-formatted-text class="scanInfoTextInvalid" value="Manual entry is not allowed. Please click Cancel and scan the card." ></lightning-formatted-text>
                            </template>
                        </div>



















                    </div>
                    <!-- Modal/Popup Box LWC footer starts here -->
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={closeModal} title="Cancel">Cancel</button>
                    </footer>

                </div>
            </section>
        </div>


        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
        <div style={showInactiveMemStyle}>            
            <template if:true={showInactiveMem}>               
               <c-crmretail_inactivemember_modal_-l-w-c_-h-u-m inactive-member-data={inactiveMemberData} oncheckin={handleCheckIn} oncloseinactivemodal={handleInactiveModalClose} source-comp={sourceComp}></c-crmretail_inactivemember_modal_-l-w-c_-h-u-m>
               <div class="slds-backdrop slds-backdrop_open"></div>
            </template>
        </div>    

    <c-crm-retail_-generic-modal_-l-w-c_-h-u-m open-modal={showInactiveMem} show-close="true" no-footer="true" title={headertitle} onclose={handleInactiveModalClose}>

            <div slot="body">

                <div>
                    <p class="slds-align_absolute-left displayMsg">{displayMsg}</p>
                    <p class="slds-align_absolute-left displayMsg">{continuationMsg}</p>
                </div>

                <lightning-datatable if:true={hasVisitorRecords} key-field="Id" data={tableData} hide-checkbox-column="true" columns={inactiveColumns}></lightning-datatable>

                <div class="slds-align_absolute-center buttonsDiv">

                    <lightning-button if:true={hasVisitorRecords} variant="brand" name="Onsite Check-in" style="padding-right:15px;" label="Onsite Check-in" onclick={handleonsitecheckin}></lightning-button>
                    <lightning-button variant="brand" name="New" label="New" onclick={handleNewButtonClick}></lightning-button>
                
                </div>

            </div>

    </c-crm-retail_-generic-modal_-l-w-c_-h-u-m>

    <c-crm-retail_-generic-modal_-l-w-c_-h-u-m style="--modal-max-width:40rem" open-modal={showFutureCheckInModal} title={futureModalTitle} onclose={handleFutureCloseModal}>

        <div slot="body"> {futureModalMessage} </div>   
        <button slot="footer" class="slds-button slds-button_neutral" onclick={handleFutureCloseModal} title="Cancel">{cancelButtonLabel}</button>

    </c-crm-retail_-generic-modal_-l-w-c_-h-u-m>


</template>