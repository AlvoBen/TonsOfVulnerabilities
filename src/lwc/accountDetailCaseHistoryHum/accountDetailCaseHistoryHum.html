<!--
LWC Name        : accuntDetailCaseHistoryHum.html
Function        : LWC to display Case History section on member details pages.

Modification Log:
* Developer Name                  Date                         Description
*
* Raj kishore                   11/20/2020                Original Version 
* Mohan                         03/09/2020                Fixing filter panel alignment issues 
* Mohan                         04/12/2021                US-2032407 case history view all, breadcrumbs
* Kajal Namdev                  08/12/2021                US-2306063 Group account label update
* Supriya                       08/23/2021                US-2363825 Standardized icons
* Supriya                       09/02/2021                DF-3674
* Supriya Shastri               09/06/2021                Added grey headers to member detail table
* Supriya Shastri               10/28/2021                US-2440592
* Gowthami Thota                10/29/2021                US-1749572/2477381 MF1-Case History - GBO Page Updates & Case History Filters
* Supriya Shastri               11/08/2021                UI spacing issue addressed
* Gowthami Thota                2/3/2022                  US- 2081786 Case Management - Case Linking
* Abhishek Mangutkar			05/09/2022				  US-2871585
* Ritik Agarwal                 11/01/2022                Added new case button
* Ankima/Isha                   07/18/2022                Added condition to show info message for archived case functionality
* Muthukumar					09/19/2023				  Disablement of new case creation for legacy member (Account Level)
* Prasuna Pattabhi				09/27/2023				  US-4809356 Person Account Page - Interacting With Type Filter Missing on Case History section - (Lightning)
* Prasuna Pattabhi				10/06/2023				  US-4809356 Person Account Page - Interacting With Type Filter Missing on Case History section - (Lightning) - Added Switch
****************************************************************************************************************************-->
<template>
    <article class="slds-card slds-card_boundary slds-grid slds-grid--vertical full-container hc-case-history">
        <div class="hc-standard-table-styles">
            <c-generic-bread-crumbs-hum if:true={bInfiniteScroll} items={breadCrumbItems}></c-generic-bread-crumbs-hum>
            <header class=" slds-card__header slds-grid slds-p-right_none slds-media slds-media_center slds-has-flexi-truncate hc-align-header">
                <div class="slds-grid slds-grid_vertical-align-center">
                    <div class="slds-media__figure">
                        <lightning-icon icon-name="standard:case"></lightning-icon>
                    </div>
                    <div class="slds-media__body">
                        <h2 class="slds-card__header-title">Case History ({totalPolicies})</h2>
                    </div>
                </div>
                <div class="slds-grid">
                    <div class="slds-grid slds-grid_align-end slds-m-right_x-small" if:false={isProvider}>
                        <div class="slds-grid">
                            <lightning-input type="checkbox" onchange={enableNew} data-id="checkbox" variant="label-hidden" disabled={grayOutCheckBox}>
                            </lightning-input>
                            <div class="slds-grid slds-grid_align-end slds-col slds-size_9-of-12" if:true={isGroupCaseHistory}>
                                <label class="ch-checkbox-label">{labels.Group_Case_History_Checkbox_Msg}</label>
                            </div>
                            <div class="slds-grid slds-col slds-size_9-of-12" if:false={isGroupCaseHistory}>
                                <label class="ch-checkbox-label">{labels.Case_History_Checkbox_Msg}</label>
                            </div>
                            <lightning-helptext content={labels.CASE_HISTORY_POPUP} class="start-help-text">
                            </lightning-helptext>
                        </div>
                    </div>
                    <div class="slds-grid">
                        <lightning-button class="slds-p-right_x-small" variant="brand-outline" label="New Case"
                            disabled={enableNewbutton} onclick={createNewCase}></lightning-button>
                        <lightning-button class="slds-p-right_x-small" variant="brand-outline" label="Link Case"
                            disabled={enableLinkbutton} onclick={handleLinkCase}></lightning-button>
                        <lightning-helptext content={labels.LinkCasesHelpHover_HUM} class="start-help-text"
                            onfocus={onFormItemFocus}>
                        </lightning-helptext>
                    </div>
                </div>
            </header>
            <div class="slds-grid slds-wrap slds-gutters slds-grid slds-grid_align-end">
                <div class="slds-grid slds-size_6-of-12"> 
                </div>
            </div>
            <template if:true={showArchivedCase}>
                <div class="slds-grid slds-grid_vertical-align-center slds-p-around_x-small infomsg-placement">
                    <lightning-icon class="info-alt-icon" icon-name="utility:info_alt" size="x-small">
                    </lightning-icon>
                    <span class="slds-m-left_x-small history-warn-msg">{showArchivalInfoMsg}</span>
                </div>
            </template>
            <lightning-layout slot="actions" vertical-align="end" horizontal-align="end" class="slds-p-bottom_small">

                <div class="slds-col ch-filter-keyword slds-p-horizontal_x-small">
                    <lightning-input class="inputfield keyword-field state-field" type="text" name="keyword" label="Filter by keyword" 
                        value={keyword} onchange={findByWord} onfocus={onFormItemFocus}>
                    </lightning-input>
                </div>
                <div class="slds-col ch-date-picker slds-p-horizontal_x-small">
                    <label class="slds-form-element__label">{labels.caseHistoryDateLabel}</label>
                    <div class="slds-is-relative">
                        <button class="slds-button slds-button_neutral  slds-button_stretch slds-show ch-custom-date-popover" onclick={datePickerShow}>
                            <span class="slds-show slds-text-body_small slds-text-color_weak
                                    slds-show--inline-block ch-custom-date-popover">{labels.caseHistoryDateSelect}</span>
                            <lightning-icon icon-name="utility:down" alternative-text="Show More" size="xx-small"
                                class="ch-date-button-arrow ch-custom-date-popover"></lightning-icon>
                        </button>
                    </div>

                    <section aria-label="Dialog title" aria-describedby="popover-body-id"
                     role="dialog" class={bShowDatePicker}>
                        <div id="popover-body-id" class="slds-popover__body">
                            <lightning-input class="inputfield birthdate-FromInput date-input message-FromInput ch-custom-date-popover" type="text" 
                            onkeyup={formatDateOnkeyupHandler} placeholder="From" 
                            date-style="short" value={fromDate} name="fromDate" maxlength="10">
                            </lightning-input>
                            <lightning-input class="inputfield birthdate-ToInput date-input message-ToInput ch-custom-date-popover" type="text" 
                            placeholder="To" date-style="short" value={toDate} name="toDate"
                                onkeyup={formatDateOnkeyupHandler} maxlength="10">
                            </lightning-input>
                        </div>
                    </section>
                </div>
                <template if:true={isGBO}>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sProduct" label="Product" value=""
                            options={filterFldValues.sProduct} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small" >
                        <lightning-combobox class="inputfield state-field" name="sOrigin" label="Case Origin" value=""
                            options={filterFldValues.sOrigin} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small" >
                        <lightning-combobox class="inputfield state-field custom-dropdown" name="sClassification" label="Classification"
                            value="" options={filterFldValues.sClassification} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sStatus" label="Status" value=""
                            options={filterFldValues.sStatus} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                </template>
                <template if:true={isbProvider}>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field custom-dropdown" name="sClassification" label="Classification"
                            value="" options={filterFldValues.sClassification} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sIntent" label="Intent" value=""
                            options={filterFldValues.sIntent} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields-Origin slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sOwnerQueue" label="Owner Queue" value=""
                            options={filterFldValues.sOwnerQueue} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sStatus" label="Status" value=""
                            options={filterFldValues.sStatus} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                </template>
                <template if:true={isbPharmacy}>
                    <div class="slds-col ch-picker-field slds-p-horizontal_x-smalls">
                        <lightning-combobox class="inputfield state-field" name="sStatus" label="Status" value=""
                            options={filterFldValues.sStatus} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field custom-dropdown" name="sClassification" label="Classification"
                            value="" options={filterFldValues.sClassification} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sIntent" label="Intent" value=""
                            options={filterFldValues.sIntent} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <template if:true={isSwitchOn4809356}>
                        <div class="slds-col ch-picker-fields-Origin slds-p-horizontal_x-small">
                            <lightning-combobox class="inputfield state-field" name="sInteractingWithType" label="Interacting With Type" value=""
                            options={filterFldValues.sInteractingWithType} onchange={selectFilter} onfocus={onFormItemFocus}>
                            </lightning-combobox>
                        </div>
                    </template>
                </template>
                <template if:true={isbRcc}>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sStatus" label="Status" value=""
                            options={filterFldValues.sStatus} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field custom-dropdown" name="sClassification" label="Classification"
                            value="" options={filterFldValues.sClassification} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields-Origin slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sInteractingWithType" label="Interacting With Type" value=""
                            options={filterFldValues.sInteractingWithType} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sDCN" label="DCN Present" value=""
                            options={filterFldValues.sDCN} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                </template>
                <template if:true={isGeneral}>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field custom-dropdown" name="sClassification" label="Classification"
                            value="" options={filterFldValues.sClassification} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields- slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sIntent" label="Intent" value=""
                            options={filterFldValues.sIntent} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col ch-picker-fields slds-p-horizontal_x-small">
                        <lightning-combobox class="inputfield state-field" name="sStatus" label="Status" value=""
                            options={filterFldValues.sStatus} onchange={selectFilter} onfocus={onFormItemFocus}>
                        </lightning-combobox>
                    </div>   
                </template>
                <div class="slds-col ch-clear-filters slds-p-horizontal_x-small">
                    <div class="slds-p-top_large" onclick={selectFilter}>
                        <lightning-icon class="health-filter-icon slds-p-around_x-small" name='clear'
                        icon-name={iconName} size="x-small" alternative-text="Clear Filters">
                        </lightning-icon>
                    </div>
                </div>
            </lightning-layout>
            <div class="">
                <c-standard-filter-pills-hum filter-config-obj={filterObj} filter-values={pillFilterValues}
                    onremovepill={handleRemove}>
                </c-standard-filter-pills-hum>
            </div>
            <template if:true={showArchivedCase}>
                <div class="custom-tooltip-link link-placement" onclick={openArchivedCases}>Archived Case History</div>
            </template>
        </div>
        <div class="slds-grid full-container slds-is-relative slds-p-horizontal_none">
            <template if:true={resultsTrue}>
                <c-standard-table-component-hum class="full-container hc-account-detail-standard-table" standard-table-accordian-hum=true name-of-screen="Case Search"
                     response={oData} oncheckboxcheck={handlecheckboxcheck} oninteractions={handleInteraction} is-enable-accordion = "true"
                    templatemodal={oCaseHistoryModel} show-view-all={showViewAll} no-data-message={labels.Hum_NoResultsFound} 
                    b-hide-title=true ontabopen={handleAppliedFilters} b-infinite-scroll={bInfiniteScroll} 
                    o-view-all-params={oViewAllParams} onlinkclick={handleclicked} default-header-icon='standard:case' related-input-field={loggingRelatedField} screen-name="Case History">
                </c-standard-table-component-hum>
            </template>
        </div>
    </article>
</template>