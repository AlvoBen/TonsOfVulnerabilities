<!--
Function        : LWC PharmacyHpieCreateOrderHum.html

Modification Log:
* Developer Name                  Date                         Description
*------------------------------------------------------------------------------------------------------------------------------
* Vishal Shinde                  29/02/2024                     US - 5142800-Mail Order Management - Pharmacy - "Prescriptions & Order Summary" tab - Prescriptions – Create Order
***************************************************************************************************************************** -->
<template>
    <lightning-card>
        <template if:true={loaded}>
            <div class="slds-grid slds-grid_align-spread topdiv">
                <div class="slds-col">
                    <lightning-icon size="x-small" style="cursor: pointer;"
                        class="slds-icon slds-input__icon slds-input__icon_right slds-icon-text-default"
                        icon-name="utility:back" onclick={goToSummary}></lightning-icon><b
                        class="slds-text-body_regular">Order</b>
                </div>
                <div class="slds-col">
                    <lightning-button label="Add Prescription" title="Add Prescription" onclick={handleAddPrescription}>
                    </lightning-button>
                </div>
            </div>
            <div class="slds-gutters slds-grid slds-m-top_x-small">
                <div class="slds-col slds-size_2-of-12">
                    <c-generic-date-selector dlabel="Release" dkeyname="ReleaseDate" dminvalue={sMinDate}
                        dvalue={sStartDate} oninvaliddate={handleInvalidReleaseDate} onsenddatedata={handleDateChange}>
                    </c-generic-date-selector>
                </div>
                <div class="slds-col slds-size_2-of-12">
                    <div class="slds-m-top_large">
                        <span> Cap Type : {capType}</span>
                    </div>
                </div>
            </div>
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-small slds-wrap">
                <div class="slds-col slds-size_1-of-1">
                    <template if:true={prescriptionsData}>
                        <template for:each={prescriptionsData} for:item="item">
                            <div key={item.key} class="slds-var-m-top_x-small">
                                <c-Pharmacy-hpie-create-order-prescription-hum item={item}
                                    onremovepres={handleRemovePrescription}>
                                </c-Pharmacy-hpie-create-order-prescription-hum>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-small slds-wrap">
                <div class="slds-col">
                    <div class="slds-text-body_regular"><strong>Shipping Details</strong></div>
                </div>
                <div class="slds-col">
                    <div class="slds-grid slds-grid_align-end slds-gutters">
                        <div class="slds-col">
                            <lightning-button label="New Credit Card" title="New Credit Card" onclick={handleNewClick}>
                            </lightning-button>
                        </div>
                        <div class="slds-col">
                            <lightning-button label="Edit Credit Card" title="Edit Credit Card"
                                onclick={handleEditClick}>
                            </lightning-button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-small">
                <div class="slds-col slds-size_4-of-12">
                    <lightning-combobox name="progress" label="Shipping Method" value={selectedShippingMethod}
                        placeholder="Shipping Method" options={shippingoptions} onchange={handleShippingChange} required
                        dropdown-alignment="auto">
                    </lightning-combobox>
                </div>
                <div class="slds-col slds-size_6-of-12">
                    <lightning-combobox name="progress" label="Payment Method" value={paymentMethod}
                        placeholder="Credit Card" options={lstPaymentMethods} onchange={handlePaymentChange} required
                        dropdown-alignment="auto">
                    </lightning-combobox>
                </div>
            </div>
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-large">
                <div class="slds-col slds-size_1-of-1">
                    <c-pharmacy-hpie-modify-shipping-address lwc:if={demoDetailLoaded} enterprise-id={enterpriseId}
                        record-id={recordId} network-id={networkId} pharmacymemberaddresss={pharmacyaddress}
                        demographics-data={pharmacyDemoDetails} oncalldemographics={handleCallDemographics}
                        dropdown-alignment="auto" user-id={userId} onshippingaddress={updateShippingAddress}
                        onshowcaseblock={handleShowCase} onaddaddressclick={handleAddAddress}
                        onshippingaddresscomments={getAddressComments}>
                    </c-pharmacy-hpie-modify-shipping-address>
                </div>
            </div>
            <div class="slds-m-top_small">
                <div class="createeditcreditcard">
                    <template if:true={isCreateAndEditCreditCardVisible}>   
                        <c-pharmacy-hpie-create-edit-credit-card-hum record-id={recordId} enterprise-id={enterpriseId}
                            network-id={networkId} component-mode={createAndEditCreditCardComponentMode} user-id={userId}
                            credit-card-data={creditCardData} selected-row-data={selectedRowData} onsave={handleSave}
                            oncancel={handleCancel} oncreditcardkey={handleCreditKey}
                            oncreditcardcomment={getCreditCardComment} order={isCreateOrder}>
                        </c-pharmacy-hpie-create-edit-credit-card-hum>
                    </template>
                </div>
            </div>
        </template>
        <template if:false={loaded}>
            <lightning-spinner alternative-text="Loading...">
            </lightning-spinner>
        </template>
        <template if:true={showCaseCommentBox}>
            <c-generic-case-comment-logging record-id={recordId} responseobj={createOrderDataObj}
                onsavedata={handleSubmitClick} submit={isSubmit} disabled={submitDisabled} oncancel={handleCancelClick}
                onfinish={handleFinishLogging} is-credit-card={isCreditCard} pharmacy-temp={isPharmacyTemp}
                hide-popover={isPharmacyTemp}  onpasscasenumber={handleCaseNumber}>
            </c-generic-case-comment-logging>  
        </template>

    </lightning-card>
</template>
