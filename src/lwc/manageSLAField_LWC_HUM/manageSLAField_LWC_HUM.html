<!--**************************************************************************************************************
LWC Name        : ManageSLAField_LWC_HUM.html
Version         : 1.0
Created On      : 05/06/2021
Function        : This LWC component to manage SLA related fields on WorkQueueSetup Object

* Modification Log:
* Developer Name            Code Review                 Date                       Description
*----------------------------------------------------------------------------------------------------------------
* Vijaykumar                                          05/06/2021                  US-2224460  T1PRJ0001827- IR 5050 - Create new " Manage SLA setup" page -WQ summary & Queue View (CRM)
* Vijaykumar                                          05/19/2021                  DF-3067 fix
*****************************************************************************************************************-->

<template>
   <lightning-card>
           <div class="slds-align_absolute-center" style="height:1rem"> 
            <lightning-button type="submit" variant="brand-outline" title="Save" label="Save" disabled={bIsButtonDisabled} onclick={updateWQSData}></lightning-button>&nbsp;&nbsp;
               <lightning-button type="cancel" variant="brand-outline" title="Reset" label="Reset" disabled={bIsButtonDisabled} onclick={handleResetClick}></lightning-button>&nbsp;&nbsp;
               <lightning-button variant="brand-outline" label="Back to Details" onclick={handleGoBack}></lightning-button>&nbsp;&nbsp;
           </div> 
           <lightning-accordion allow-multiple-sections-open active-section-name={activeSections}>
             <lightning-accordion-section name="1" label="Work Queue Setup Summary">
                <div class="slds-form-element slds-form-element_horizontal">
                    <lightning-input type="string" label="Service Center" value={serviceCenter} readonly></lightning-input>
                    <lightning-input type="string" label="Department" value={department} readonly></lightning-input>
                    <lightning-input type="string" label="Work Queue Setup Name" value={name} readonly></lightning-input>
                    <lightning-input type="string" label="Queue Description" value={queueDesc} readonly></lightning-input>
                </div> 
           </lightning-accordion-section>
           
           <lightning-accordion-section name="2" label="Work Queue SLA Details">
                <lightning-layout>
                    <lightning-layout-item>
                        <lightning-input type="number" label="SLA In Days" value={slaDays} class="cSLAInDays"  name="slaInDays" maxlength="3" onchange={handledChange}></lightning-input>
                    </lightning-layout-item>
                </lightning-layout>
                <div class="slds-p-top_x-small">
                    <lightning-input type="checkbox" label ="SLA On Case Transfer" name="slaOnTransfer" checked={slaOnTransfer} onchange={handledChange}></lightning-input> 
                </div>
                <div class="slds-p-top_x-small">
                   <lightning-input type="checkbox" label="SLA Email Alert" checked={slaEmailAlert} disabled></lightning-input> 
                </div>
          </lightning-accordion-section>

          <lightning-accordion-section name="3" label="Queue View SLA Details">
               <div class="slds-align_absolute-center" style="height:1rem"> 
               <lightning-button type="submit" variant="brand-outline" title="Save" label="Save"  disabled={bIsQvButtonDisabled} onclick={handleSaveAllQvVal}></lightning-button>&nbsp;&nbsp;
               <lightning-button type="reset" variant="brand-outline" title="Reset" label="Reset" disabled={bIsQvButtonDisabled}  onclick={handleResetVal}></lightning-button>
               </div>
               <lightning-input type="checkbox" label ="Match all SLA with Work Queue ?" checked={bmatchAllWq} name="matchAllWqname" disabled={bHasQVlst} onchange={handledChange}></lightning-input>
                <div class="slds-p-top_xx-small">
                    <lightning-input type="checkbox" label ="Match all SLA On Case Transfer with Work Queue ?" checked={bmatchAllCtWq} name="matchAllCtWqName" disabled={bHasQVlst} onchange={handledChange}></lightning-input> <br/><br/>
            </div>
               <template if:true={queueViewData}>
                <div style="height: 250px; " class="slds-border_top "> 
               <lightning-datatable
                   key-field="Id"
                   data={queueViewData}
                   hide-checkbox-column
                   columns={columns}
                   onsave={handleSave}
                   draft-values={draftValues}>
               </lightning-datatable> 
               </div>
            </template>
       </lightning-accordion-section>    
</lightning-accordion>
</lightning-card>

<template if:true={bIsModalOpen}>
<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
   <div class="slds-modal__container">
       <header class="slds-modal__header">
           <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Success!</h2>
       </header>
       <div if:false={bIsQVUpdate} class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
           <p><b>{name}</b> has been updated succesfully!.</p>
       </div>  
       <div if:true={bIsQVUpdate} class="slds-modal__content slds-p-around_medium" id="modal-content-id-3">
        <p>Queue View(s) has been updated succesfully!.</p>
    </div>       
       <footer class="slds-modal__footer">
           <button class="slds-button slds-button_brand" onclick={handlePopUpOkClick} title="OK">OK</button>
       </footer>
   </div>
</section>
 <div class="slds-backdrop slds-backdrop_open"></div> 
</template>

    <template if:true={bIsAllQVUpdate}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
           <header class="slds-modal__header">
               <h2 id="modal-heading-03" class="slds-text-heading_medium slds-hyphenate slds-float_left">Confirm</h2>
           </header>
           <div  class="slds-modal__content slds-p-around_medium" id="modal-content-id-4">
               <p>Are you sure you want to override all Queue View SLA with its Work Queue?</p>
           </div>  
           <footer class="slds-modal__footer">
               <div class="slds-align_absolute-center">
               <button class="slds-button slds-button_brand" onclick={handleYesClick} title="YES">YES</button> <div class="slds-p-left_xx-large"></div>
               <button class="slds-button slds-button_brand" onclick={handleNoClick} title="NO">NO</button> <!-- handleNoClick-->
            </div>
           </footer>
       </div>
       </section>
   <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
    <template if:true={showErrorPopup}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
           <div class="slds-modal__container">
               <header class="slds-modal__header">
                   <h2 id="modal-heading-04" class="slds-text-heading_medium slds-hyphenate">Error!</h2>
               </header> 
               <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-5">
                <p> Please enter SLA (In days) as number between 0 - 400</p>
            </div>       
               <footer class="slds-modal__footer">
                   <button class="slds-button slds-button_brand" onclick={handleQVPopUp} title="OK">OK</button>
               </footer>
           </div>
        </section>
         <div class="slds-backdrop slds-backdrop_open"></div> 
        </template>   
</template>