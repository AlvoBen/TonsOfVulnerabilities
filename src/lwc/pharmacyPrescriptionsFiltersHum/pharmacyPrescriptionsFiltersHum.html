<!--
/*
LWC Name        : PharmacyPrescriptionsFilersHum.html
Function        : LWC to display pharmacyPrescriptionFilter deatails.

Modification Log:
* Developer Name                  Date                         Description
*
* Swapnali Sonawane               12/05/2022                   US- 3969790 Migration of the order queue detail capability
* Swapnali Sonawane               01/20/2023                   US- 4146078 Mail Order Pharmacy- Address/Close the gaps identified during user testing. - 1
* Vishal Shinde                   10/04/2023                   US - 4889785 - Add the 100 Day Supply indicator to CRM Service - Lightning
****************************************************************************************************************************/
-->
<template>
    <template if:false={isCreateOrderClicked}>
        <lightning-card>
            <div class="slds-grid slds-grid_align-spread">
                <div class="slds-col">
                    <h3>
                        <span class="slds-page-header__title slds-truncate" title="Member Prescriptions">
                            Member
                            Prescriptions
                        </span>
                    </h3>
                </div>
                <div class="slds-col">
                    <div class="slds-grid slds-grid_align-end slds-gutters">
                        <div class="slds-col">
                            <lightning-button-icon icon-name="utility:refresh" variant="border-filled" size="small"
                                                   alternative-text="Refresh"
                                                   class="slds-var-m-right_small slds-var-m-top_x-small slds-float_right" title="Refresh" onclick={refreshData}>
                            </lightning-button-icon>
                        </div>
                        <div class="slds-col">
                            <lightning-button label="Create Order" title="Create Order" onclick={handleCreateOrderClick}
                                              disabled={createOrderDisable} class="slds-float_right">
                            </lightning-button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slds-grid slds-m-top_medium slds-wrap">
                <div class="slds-col slds-size_4-of-12">
                    <div class="slds-grid slds-gutters">
                        <div class="slds-col">
                            <div class="slds-form-element">
                                <label class="slds-checkbox_toggle slds-grid">
                                    <span class="slds-form-element__label slds-m-bottom_none">Cap Type</span>
                                    <input type="checkbox" name="checkbox-toggleCapType" value="Cap Type"
                                           aria-describedby="Cap Type" onchange={toggleCapType} checked={capTypeFlag} />
                                    <span id="checkbox-toggle-captype1" class="slds-checkbox_faux_container"
                                          aria-live="assertive">
                                        <span class="slds-checkbox_faux"></span>
                                        <span class="slds-checkbox_on">S-Safety {capValue}</span>
                                        <span class="slds-checkbox_off">E-Easy</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                        <div class="slds-col">
                            <div class="slds-form-element">
                                <label class="slds-checkbox_toggle slds-grid">
                                    <span class="slds-form-element__label slds-m-bottom_none">Member Consent</span>
                                    <input type="checkbox" name="checkbox-toggleMemberConsent" value="Member Consent"
                                           aria-describedby="Member Consent" onchange={toggleMemberConsent}
                                           checked={memberConsentFlag} />
                                    <span id="checkbox-toggle-memberConsent1" class="slds-checkbox_faux_container"
                                          aria-live="assertive">
                                        <span class="slds-checkbox_faux"></span>
                                        <span class="slds-checkbox_on">{memberConsentApprovedDate}</span>
                                        <span class="slds-checkbox_off">Disabled</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-col slds-size_8-of-12">
                    <div class="slds-grid">
                            <div class="slds-col slds-size_5-of-12">
                            <c-pharmacy100-day-prescrip-hum  account-id={recordId}></c-pharmacy100-day-prescrip-hum>
                            </div>
                    </div>
                </div>
            </div>
                    <div class="slds-grid slds-m-top_medium slds-wrap slds-gutters">
                        <div class="slds-col slds-size_4-of-12">
                            <c-generic-keyword-search-hum minchar="3" placeholder="Filter By" name="searchByWord" keyword={keyword} ontextclear={clearSearchData}
                                                          onkeywordvalue={handleKeywordSearch}>
                            </c-generic-keyword-search-hum>
                        </div>
                        <div class="slds-col slds-size_4-of-12">
                            <c-generic-multiselect-picklist-hum keyname="Status" options={filterStatusValues.Status}
                                                                placeholdermessage="Status" onmultiselectfilter={handlePicklistFilter}>
                            </c-generic-multiselect-picklist-hum>
                        </div>
                        <div class="slds-col slds-size_4-of-12">
                            <lightning-combobox name="sSortBy" onchange={getSortedValue} options={sSortBy} value=""
                                                placeholder="Sort By" variant="label-hidden">
                            </lightning-combobox>
                        </div>
                    </div>
            <!--<div class="slds-grid slds-m-top_medium slds-wrap">
                <div class="slds-col slds-size_4-of-12">
                    <div class="slds-grid slds-gutters">
                        <div class="slds-col">
                            <div class="slds-form-element">
                                <label class="slds-checkbox_toggle slds-grid">
                                    <span class="slds-form-element__label slds-m-bottom_none">Cap Type</span>
                                    <input type="checkbox" name="checkbox-toggleCapType" value="Cap Type"
                                           aria-describedby="Cap Type" onchange={toggleCapType} checked={capTypeFlag} />
                                    <span id="checkbox-toggle-captype1" class="slds-checkbox_faux_container"
                                          aria-live="assertive">
                                        <span class="slds-checkbox_faux"></span>
                                        <span class="slds-checkbox_on">S-Safety {capValue}</span>
                                        <span class="slds-checkbox_off">E-Easy</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                        <div class="slds-col">
                            <div class="slds-form-element">
                                <label class="slds-checkbox_toggle slds-grid">
                                    <span class="slds-form-element__label slds-m-bottom_none">Member Consent</span>
                                    <input type="checkbox" name="checkbox-toggleMemberConsent" value="Member Consent"
                                           aria-describedby="Member Consent" onchange={toggleMemberConsent}
                                           checked={memberConsentFlag} />
                                    <span id="checkbox-toggle-memberConsent1" class="slds-checkbox_faux_container"
                                          aria-live="assertive">
                                        <span class="slds-checkbox_faux"></span>
                                        <span class="slds-checkbox_on">{memberConsentApprovedDate}</span>
                                        <span class="slds-checkbox_off">Disabled</span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-col slds-size_8-of-12">
                    <div class="slds-grid">
                        <div class="slds-col slds-size_2-of-12">
                            <lightning-button variant="brand-outline" label="Inactive RX" title="Inactive RX"
                                              onclick={handleClick} class="slds-m-left_x-small"></lightning-button>
                        </div>
                        <div class="slds-col slds-size_5-of-12">
                            <c-pharmacy100-day-prescrip-hum account-id={recordId}></c-pharmacy100-day-prescrip-hum>
                        </div>
                    </div>
                </div>
            </div>
                    <div class="slds-grid slds-m-top_medium slds-wrap slds-gutters">
                        <div class="slds-col slds-size_4-of-12">
                            <c-generic-keyword-search-hum minchar="3" placeholder="Filter By" name="searchByWord"
                                                          keyword={keyword} ontextclear={clearSearchData} onkeywordvalue={handleKeywordSearch}>
                            </c-generic-keyword-search-hum>
                        </div>
                        <div class="slds-col slds-size_4-of-12">
                            <c-generic-multiselect-picklist-hum keyname="Status" options={filterStatusValues.Status}
                                                                placeholdermessage="Status" onmultiselectfilter={handlePicklistFilter}>
                            </c-generic-multiselect-picklist-hum>
                        </div>
                        <div class="slds-col slds-size_4-of-12">
                            <lightning-combobox name="sSortBy" onchange={getSortedValue} options={sSortBy} value=""
                                                placeholder="Sort By" variant="label-hidden">
                            </lightning-combobox>
                        </div>
                    </div>-->
            <div class="slds-grid slds-grid_align-spread slds-m-top_x-small">
                <div class="slds-col">
                    <template if:true={pillFilterValues}>
                        <template for:each={pillFilterValues} for:item="pill" for:index="ind">
                            <lightning-pill class="slds-m-around_x-small" data-index={ind} data-key={pill.key}
                                            data-value={pill.value} label={pill.value} key={pill.key} onremove={handlePillRemove}>
                            </lightning-pill>
                        </template>
                    </template>
                </div>
            </div>
        </lightning-card>
        <lightning-card>
            <template if:true={loaded}>
                <template if:true={dataFound}>
                    <div class="slds-grid slds-p-bottom_xx-small">
                        <div class="slds-col">
                            <div class="slds-var-m-top_large">
                                <div class="slds-border_top">
                                </div>
                            </div>
                        </div>
                        <div>
                            <lightning-button class="slds-align_absolute-center" variant="brand-outline"
                                              disabled={isMorePrescription} style="width: 100%;" label="Show More"
                                              onclick={ShowMoreCards}>
                            </lightning-button>
                        </div>
                        <div class="slds-col">
                            <div class="slds-var-m-top_large">
                                <div class="slds-border_top">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-grid slds-grid_align-end slds-m-top_x-small">
                        <div class="slds-col">
                            <span style="text-align: right;">{filteredcount} of {totalcount} results</span>
                        </div>
                    </div>
                </template>
            </template>
            <template if:true={loaded}>
                <template if:true={serviceerror}>
                    <c-generic-scoped-notification-hum iconname="utility:error"
                                                       message={labels.prescriptionServiceError} type="error">
                    </c-generic-scoped-notification-hum>
                </template>
                <template if:false={serviceerror}>
                    <template if:true={dataFound}>
                        <div class="slds-scrollable_y" style="height: 400px;" onscroll={handlescroll}>
                            <lightning-layout multiple-rows="true">
                                <template if:true={finalPrescriptionList}>
                                    <template for:each={finalPrescriptionList} for:item="prscription" for:index="index">
                                        <template if:true={prscription.detailSection}>
                                            <lightning-layout-item size="3" key={prscription.key} class="slds-p-around_xx-small"
                                                                   style="cursor: pointer;min-height: 210px;">
                                                <c-pharmacy-prescription-card-hum oncardclickselect={handleCardClickSelect}
                                                                                  onaddcart={handleAddCart} prckey={prscription.key}
                                                                                  item={prscription.prescriptions} addtocart={prscription.addToCart}
                                                                                  selectedindex={prscription.counter} icon={prscription.icon}
                                                                                  onautorefill={handleAutoRefill} network-id={networkId}
                                                                                  order-eligible={prscription.OrderEligible}>
                                                </c-pharmacy-prescription-card-hum>
                                            </lightning-layout-item>
                                            <lightning-layout-item class="detailsection" size="12" key={prscription.key}
                                                                   data-id={prscription.counter} style="display:none;"
                                                                   data-value={prscription.counter}>
                                                <c-pharmacy-prescription-detail-hum oncardclose={handleCloseClick}
                                                                                    prckey={prscription.key} icon={prscription.icon}
                                                                                    onaddorder={handleAddCart}>
                                                </c-pharmacy-prescription-detail-hum>
                                            </lightning-layout-item>
                                        </template>
                                        <template if:false={prscription.detailSection}>
                                            <lightning-layout-item size="3" key={prscription.key} class="slds-p-around_xx-small"
                                                                   style="cursor: pointer;min-height: 210px;">
                                                <c-pharmacy-prescription-card-hum oncardclickselect={handleCardClickSelect}
                                                                                  order-eligible={prscription.OrderEligible} prckey={prscription.key}
                                                                                  item={prscription.prescriptions} addtocart={prscription.addToCart}
                                                                                  selectedindex={prscription.counter} icon={prscription.icon} network-id={networkId}
                                                                                  onautorefill={handleAutoRefill} onaddcart={handleAddCart}>
                                                </c-pharmacy-prescription-card-hum>
                                            </lightning-layout-item>
                                        </template>
                                    </template>
                                </template>
                            </lightning-layout>
                        </div>
                    </template>
                    <template if:false={dataFound}>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_1-of-1 slds-m-top_small slds-wrap">
                                <c-generic-scoped-notification-hum iconname="utility:info" message="No Prescriptions are available for selected member.">
                                </c-generic-scoped-notification-hum>
                            </div>
                        </div>
                    </template>
                </template>
            </template>
            <template if:false={loaded}>
                <lightning-spinner alternative-text="Loading"></lightning-spinner>
            </template>
        </lightning-card>
        <template if:true={openCapTypeModal}>
            <div class="slds-modal slds-fade-in-open slds-backdrop">
                <div class="slds-modal__container">
                    <!------HEADER Section-->
                    <div class="slds-modal__header">
                        <lightning-button-icon icon-name="utility:close" alternative-text="Close this window" size="large"
                                               variant="bare-inverse" onclick={closeModal} class="slds-modal__close">
                        </lightning-button-icon>
                        <h1 class="slds-text-heading_large">Cap Type</h1>
                    </div>
                    <!------Body Section-->
                    <template if:true={capTypeFlag}>
                        <div class="slds-modal__content slds-var-p-around_medium">
                            <P class="slds-text-align_center slds-var-m-top_xx-large slds-var-m-bottom_xx-large">
                                You are
                                about to change the Cap Type to <b>"E-Easy"</b>. <br>
                                Are you sure?
                            </P>
                        </div>
                    </template>
                    <template if:false={capTypeFlag}>
                        <div class="slds-modal__content slds-var-p-around_medium">
                            <P class="slds-text-align_center slds-var-m-top_xx-large slds-var-m-bottom_xx-large">
                                You are
                                about to change the Cap Type to <b>"S-Safety"</b>. <br>
                                Are you sure?
                            </P>
                        </div>
                    </template>
                    <!------Footer Section-->
                    <div class="slds-modal__footer">
                        <lightning-button label="No" title="No" onclick={closeModal} class="slds-var-m-right_small">
                        </lightning-button>
                        <lightning-button label="Yes" variant="brand" onclick={updateCapTypeValue}></lightning-button>
                    </div>
                </div>
            </div>
        </template>
        <template if:true={openMemberConsentModal}>
            <div class="slds-modal slds-fade-in-open slds-backdrop">
                <div class="slds-modal__container">
                    <!------HEADER Section-->
                    <div class="slds-modal__header">
                        <lightning-button-icon icon-name="utility:close" alternative-text="Close this window" size="large"
                                               variant="bare-inverse" onclick={closeModal} class="slds-modal__close">
                        </lightning-button-icon>
                        <h1 class="slds-text-heading_large">Member Consent</h1>
                    </div>
                    <!------Body Section-->
                    <template if:true={memberConsentFlag}>
                        <div class="slds-modal__content slds-var-p-around_medium">

                            <P class="slds-text-align_center slds-var-m-top_xx-large slds-var-m-bottom_xx-large">
                                Do you want
                                to change Member Consent to Request<br>
                                Consent to Each Order for every prescription?
                            </P>

                        </div>
                    </template>
                    <template if:false={memberConsentFlag}>
                        <div class="slds-modal__content slds-var-p-around_medium">
                            <P class="slds-text-align_center slds-var-m-top_xx-large slds-var-m-bottom_xx-large">
                                Do you want
                                to change the member consent to Approved<br>
                                for all prescriptions?
                            </P>
                        </div>
                    </template>
                    <!------Footer Section-->
                    <div class="slds-modal__footer">
                        <lightning-button label="No" title="No" onclick={closeModal} class="slds-var-m-right_small">
                        </lightning-button>
                        <lightning-button label="Yes" variant="brand" onclick={updateMemberConsent}
                                          class="slds-var-m-right_small">
                        </lightning-button>
                    </div>
                </div>
            </div>
        </template>
    </template>
    <template if:true={isCreateOrderClicked}>
        <c-pharmacy-create-order-hum enterprise-id={enterpriseId} network-id={networkId}
                                     record-id={recordId} prescriptions={addedprescriptions}
                                     pharmacydemodetails={pharmacydemographicdetails} ongotosummary={goToSummary}
                                     onaddprescription={handleAddPrescription}>
        </c-pharmacy-create-order-hum>
    </template>
    <template if:false={isCreateOrderClicked}>
        <template if:false={createOrderDisable}>
            <div class="slds-col slds-var-m-top_large slds-p-left_xxx-small createOrder">
                <lightning-button variant="brand" label="Create Order" title="Create Order" onclick={handleCreateOrderClick}
                                  disabled={createOrderDisable} class="slds-float_right">
                </lightning-button>
            </div>
        </template>
    </template>
</template>