<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE monitor-configuration SYSTEM "monitor-configuration.dtd">

<monitor-configuration>
<monitor-semantics>

  <simple-configuration-group name="HTTP.HttpService">
		<description ID="HTTP.HttpService"></description>
  </simple-configuration-group>

    <simple-configuration-group name="HTTP.MethodNames">
          <description ID="HTTP.MethodNames"></description>
    </simple-configuration-group>

    <simple-configuration-group name="HTTP.ResponseCodes">
		<description ID="HTTP.ResponseCodes"></description>
    </simple-configuration-group>

    <simple-configuration-group name="HTTP.GeneralGroup">
		<description ID="HTTP.GeneralGroup"></description>
    </simple-configuration-group>

    <simple-configuration-group name="HTTP.MethodInstance">
		<description ID="HTTP.MethodInstance"></description>
    </simple-configuration-group>

    <simple-configuration-group name="HTTP.ResponseInstance">
		<description ID="HTTP.MethodInstance"></description>
    </simple-configuration-group>

    <integer-configuration-group name="HTTP.ActiveThreadsCount">
      <description ID="HTTP.ActiveThreadsCount">Number of currently used HTTP threads</description>
      <data-collection>
        <polled-by-monitor period="1" unit="HOUR"/>
      </data-collection>
      <thresholds green-to-yellow="0" red-to-yellow="-1" yellow-to-green="0" yellow-to-red="-1"/>
    </integer-configuration-group>

    <integer-configuration-group name="HTTP.ThreadPoolSize">
      <description ID="HTTP.ThreadPoolSize">Number of configured HTTP threads</description>
      <data-collection>
        <polled-by-monitor period="1" unit="HOUR"/>
      </data-collection>
      <thresholds green-to-yellow="0" red-to-yellow="-1" yellow-to-green="0" yellow-to-red="-1"/>
    </integer-configuration-group>

    <integer-configuration-group name="HTTP.ThreadsInProcessRate" unit="%">
      <description ID="HTTP.ThreadsInProcessRate">Rate of used to configured HTTP threads</description>
      <data-collection>
        <polled-by-monitor period="5" unit="MINUTE"/>
      </data-collection>
      <thresholds green-to-yellow="80" red-to-yellow="90" yellow-to-green="80" yellow-to-red="90"/>
    </integer-configuration-group>

    <long-configuration-group name="HTTP.AllRequestsCount">
	  <description ID="HTTP.AllRequestsCount">Number of all requests since server startup</description>
		<data-collection>
			<polled-by-monitor period="5" unit="MINUTE"/>
		</data-collection>		
	  <thresholds green-to-yellow="0" yellow-to-red="-1" red-to-yellow="-1" yellow-to-green="0"/>
    </long-configuration-group>

	<long-configuration-group name="HTTP.RequestsCount">
	  <description ID="HTTP.RequestsCount">Number of all requests using this method since server startup</description>
		<data-collection>
			<polled-by-monitor period="5" unit="MINUTE"/>
		</data-collection>		
	  <thresholds green-to-yellow="0" yellow-to-red="-1" red-to-yellow="-1" yellow-to-green="0"/>
    </long-configuration-group>

	<long-configuration-group name="HTTP.ResponsesCount">
	  <description ID="HTTP.ResponsesCount">Number for all responses that have returned this responce code</description>
		<data-collection>
			<polled-by-monitor period="5" unit="MINUTE"/>
		</data-collection>		
	  <thresholds green-to-yellow="0" yellow-to-red="-1" red-to-yellow="-1" yellow-to-green="0"/>
    </long-configuration-group>


	 <frequency-configuration-group name="HTTP.RequestsFrequency" > 
     	<description ID="HTTP.RequestsFrequency">Requests frequency</description> 
     		<data-collection react-on-failure="IGNORE" > 
     			<polled-by-monitor period="5" unit="MINUTE"/> 
     		</data-collection> 
     	<thresholds green-to-yellow="1000" yellow-to-red="2000" red-to-yellow="2000" yellow-to-green="1000"/> 
     </frequency-configuration-group>
	

</monitor-semantics>	

<monitor-tree>
  <services>
    <summary name="Http Provider" configuration-group="HTTP.HttpService">
	  <summary name="Used Request Methods" configuration-group="HTTP.MethodNames">
        <object name="%0" configuration-group="HTTP.MethodInstance">
        
		  <template-info template-name="HTTP.MonitorMethodNames">
            <polled-by-template period="5" unit="MINUTE">
              <generating-resource name="http" type="SERVICE"/>
              <template-attribute-mapping>
                <observed-resource-attribute name="MethodNames"/>
              </template-attribute-mapping>  
            </polled-by-template>
          </template-info>
  
	      <long-monitor name="RequestsCount" configuration-group="HTTP.RequestsCount">
             <monitored-resource name="http" type="SERVICE"/>
             <long-attribute-mapping>
               <long-attribute>
                <invoked-resource-method name="getRequestsCount">
			      <parameter position="0" type="String" value="%0"/>
		        </invoked-resource-method>
               </long-attribute>
             </long-attribute-mapping>
          </long-monitor>
 
	     </object>
	  </summary>

	  <summary name="Returned Response Codes" configuration-group="HTTP.ResponseCodes">
	    <object name="%0" configuration-group="HTTP.ResponseInstance">
		  <template-info template-name="HTTP.MonitorResponseCodes">
            <polled-by-template period="5" unit="MINUTE">
              <generating-resource name="http" type="SERVICE"/>
              <template-attribute-mapping>
                <observed-resource-attribute name="ResponseCodes"/>
              </template-attribute-mapping>  
            </polled-by-template>
          </template-info>

		  <long-monitor name="ResponsesCount" configuration-group="HTTP.ResponsesCount">
            <monitored-resource name="http" type="SERVICE"/>
            <long-attribute-mapping>
              <long-attribute>
                <invoked-resource-method name="getResponsesCount">
			      <parameter position="0" type="int" value="%0"/>
		        </invoked-resource-method>
              </long-attribute>
            </long-attribute-mapping>
          </long-monitor>
	    </object>
	  </summary>

	  <object name="General" configuration-group="HTTP.GeneralGroup">
		<long-monitor name="AllRequestsCount" configuration-group="HTTP.AllRequestsCount">
          <monitored-resource name="http" type="SERVICE"/>
          <long-attribute-mapping>
            <long-attribute>
              <observed-resource-attribute name="AllRequestsCount"/>
            </long-attribute>
          </long-attribute-mapping>
        </long-monitor>

	 <frequency-monitor name="Requests frequency" configuration-group="HTTP.RequestsFrequency">
		<monitored-resource name="http" type="SERVICE"/>
		<frequency-attribute-mapping>
	    	    <reported-events-attribute>
		        <observed-resource-attribute name="AllRequestsCount"/>
		    </reported-events-attribute>
	        </frequency-attribute-mapping>
	    </frequency-monitor>

        <integer-monitor name="ActiveThreadsCount" configuration-group="HTTP.ActiveThreadsCount">
          <monitored-resource name="http" type="SERVICE"/>
          <integer-attribute-mapping>
            <integer-attribute>
              <observed-resource-attribute name="ActiveThreadsCount"/>
            </integer-attribute>
          </integer-attribute-mapping>
        </integer-monitor>

        <integer-monitor name="ThreadPoolSize" configuration-group="HTTP.ThreadPoolSize">
          <monitored-resource name="http" type="SERVICE"/>
          <integer-attribute-mapping>
            <integer-attribute>
              <observed-resource-attribute name="ThreadPoolSize"/>
            </integer-attribute>
          </integer-attribute-mapping>
        </integer-monitor>

        <integer-monitor name="ThreadsInProcessRate" configuration-group="HTTP.ThreadsInProcessRate">
          <monitored-resource name="http" type="SERVICE"/>
          <integer-attribute-mapping>
            <integer-attribute>
              <observed-resource-attribute name="ThreadsInProcessRate"/>
            </integer-attribute>
          </integer-attribute-mapping>
        </integer-monitor>
	  </object>
    </summary>
  </services>
</monitor-tree>
</monitor-configuration>	